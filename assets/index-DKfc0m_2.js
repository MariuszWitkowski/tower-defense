var Lt=Object.defineProperty;var kt=(t,e,r)=>e in t?Lt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var v=(t,e,r)=>kt(t,typeof e!="symbol"?e+"":e,r);import{c as Ye,P as G}from"./phaser-CdvlyAGe.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const u of s.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&i(u)}).observe(document,{childList:!0,subtree:!0});function r(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerPolicy&&(s.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?s.credentials="include":n.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(n){if(n.ep)return;n.ep=!0;const s=r(n);fetch(n.href,s)}})();/*! *****************************************************************************
Copyright (C) Microsoft. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var ze;(function(t){(function(e){var r=typeof globalThis=="object"?globalThis:typeof Ye=="object"?Ye:typeof self=="object"?self:typeof this=="object"?this:w(),i=n(t);typeof r.Reflect<"u"&&(i=n(r.Reflect,i)),e(i,r),typeof r.Reflect>"u"&&(r.Reflect=t);function n(T,d){return function(x,R){Object.defineProperty(T,x,{configurable:!0,writable:!0,value:R}),d&&d(x,R)}}function s(){try{return Function("return this;")()}catch{}}function u(){try{return(0,eval)("(function() { return this; })()")}catch{}}function w(){return s()||u()}})(function(e,r){var i=Object.prototype.hasOwnProperty,n=typeof Symbol=="function",s=n&&typeof Symbol.toPrimitive<"u"?Symbol.toPrimitive:"@@toPrimitive",u=n&&typeof Symbol.iterator<"u"?Symbol.iterator:"@@iterator",w=typeof Object.create=="function",T={__proto__:[]}instanceof Array,d=!w&&!T,x={create:w?function(){return pe(Object.create(null))}:T?function(){return pe({__proto__:null})}:function(){return pe({})},has:d?function(a,o){return i.call(a,o)}:function(a,o){return o in a},get:d?function(a,o){return i.call(a,o)?a[o]:void 0}:function(a,o){return a[o]}},R=Object.getPrototypeOf(Function),j=typeof Map=="function"&&typeof Map.prototype.entries=="function"?Map:Rt(),F=typeof Set=="function"&&typeof Set.prototype.entries=="function"?Set:It(),ce=typeof WeakMap=="function"?WeakMap:At(),W=n?Symbol.for("@reflect-metadata:registry"):void 0,Z=Ot(),Ce=Pt(Z);function lt(a,o,l,c){if(m(l)){if(!Ue(a))throw new TypeError;if(!Ne(o))throw new TypeError;return mt(a,o)}else{if(!Ue(a))throw new TypeError;if(!P(o))throw new TypeError;if(!P(c)&&!m(c)&&!H(c))throw new TypeError;return H(c)&&(c=void 0),l=B(l),Tt(a,o,l,c)}}e("decorate",lt);function ct(a,o){function l(c,g){if(!P(c))throw new TypeError;if(!m(g)&&!bt(g))throw new TypeError;De(a,o,c,g)}return l}e("metadata",ct);function ft(a,o,l,c){if(!P(l))throw new TypeError;return m(c)||(c=B(c)),De(a,o,l,c)}e("defineMetadata",ft);function ht(a,o,l){if(!P(o))throw new TypeError;return m(l)||(l=B(l)),Re(a,o,l)}e("hasMetadata",ht);function dt(a,o,l){if(!P(o))throw new TypeError;return m(l)||(l=B(l)),fe(a,o,l)}e("hasOwnMetadata",dt);function pt(a,o,l){if(!P(o))throw new TypeError;return m(l)||(l=B(l)),Ie(a,o,l)}e("getMetadata",pt);function vt(a,o,l){if(!P(o))throw new TypeError;return m(l)||(l=B(l)),Ae(a,o,l)}e("getOwnMetadata",vt);function yt(a,o){if(!P(a))throw new TypeError;return m(o)||(o=B(o)),Ge(a,o)}e("getMetadataKeys",yt);function gt(a,o){if(!P(a))throw new TypeError;return m(o)||(o=B(o)),Le(a,o)}e("getOwnMetadataKeys",gt);function wt(a,o,l){if(!P(o))throw new TypeError;if(m(l)||(l=B(l)),!P(o))throw new TypeError;m(l)||(l=B(l));var c=Y(o,l,!1);return m(c)?!1:c.OrdinaryDeleteMetadata(a,o,l)}e("deleteMetadata",wt);function mt(a,o){for(var l=a.length-1;l>=0;--l){var c=a[l],g=c(o);if(!m(g)&&!H(g)){if(!Ne(g))throw new TypeError;o=g}}return o}function Tt(a,o,l,c){for(var g=a.length-1;g>=0;--g){var E=a[g],C=E(o,l,c);if(!m(C)&&!H(C)){if(!P(C))throw new TypeError;c=C}}return c}function Re(a,o,l){var c=fe(a,o,l);if(c)return!0;var g=de(o);return H(g)?!1:Re(a,g,l)}function fe(a,o,l){var c=Y(o,l,!1);return m(c)?!1:Be(c.OrdinaryHasOwnMetadata(a,o,l))}function Ie(a,o,l){var c=fe(a,o,l);if(c)return Ae(a,o,l);var g=de(o);if(!H(g))return Ie(a,g,l)}function Ae(a,o,l){var c=Y(o,l,!1);if(!m(c))return c.OrdinaryGetOwnMetadata(a,o,l)}function De(a,o,l,c){var g=Y(l,c,!0);g.OrdinaryDefineOwnMetadata(a,o,l,c)}function Ge(a,o){var l=Le(a,o),c=de(a);if(c===null)return l;var g=Ge(c,o);if(g.length<=0)return l;if(l.length<=0)return g;for(var E=new F,C=[],M=0,f=l;M<f.length;M++){var h=f[M],p=E.has(h);p||(E.add(h),C.push(h))}for(var y=0,_=g;y<_.length;y++){var h=_[y],p=E.has(h);p||(E.add(h),C.push(h))}return C}function Le(a,o){var l=Y(a,o,!1);return l?l.OrdinaryOwnMetadataKeys(a,o):[]}function ke(a){if(a===null)return 1;switch(typeof a){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return a===null?1:6;default:return 6}}function m(a){return a===void 0}function H(a){return a===null}function Mt(a){return typeof a=="symbol"}function P(a){return typeof a=="object"?a!==null:typeof a=="function"}function _t(a,o){switch(ke(a)){case 0:return a;case 1:return a;case 2:return a;case 3:return a;case 4:return a;case 5:return a}var l="string",c=je(a,s);if(c!==void 0){var g=c.call(a,l);if(P(g))throw new TypeError;return g}return xt(a)}function xt(a,o){var l,c,g;{var E=a.toString;if(J(E)){var c=E.call(a);if(!P(c))return c}var l=a.valueOf;if(J(l)){var c=l.call(a);if(!P(c))return c}}throw new TypeError}function Be(a){return!!a}function St(a){return""+a}function B(a){var o=_t(a);return Mt(o)?o:St(o)}function Ue(a){return Array.isArray?Array.isArray(a):a instanceof Object?a instanceof Array:Object.prototype.toString.call(a)==="[object Array]"}function J(a){return typeof a=="function"}function Ne(a){return typeof a=="function"}function bt(a){switch(ke(a)){case 3:return!0;case 4:return!0;default:return!1}}function he(a,o){return a===o||a!==a&&o!==o}function je(a,o){var l=a[o];if(l!=null){if(!J(l))throw new TypeError;return l}}function $e(a){var o=je(a,u);if(!J(o))throw new TypeError;var l=o.call(a);if(!P(l))throw new TypeError;return l}function We(a){return a.value}function He(a){var o=a.next();return o.done?!1:o}function Ve(a){var o=a.return;o&&o.call(a)}function de(a){var o=Object.getPrototypeOf(a);if(typeof a!="function"||a===R||o!==R)return o;var l=a.prototype,c=l&&Object.getPrototypeOf(l);if(c==null||c===Object.prototype)return o;var g=c.constructor;return typeof g!="function"||g===a?o:g}function Et(){var a;!m(W)&&typeof r.Reflect<"u"&&!(W in r.Reflect)&&typeof r.Reflect.defineMetadata=="function"&&(a=Ct(r.Reflect));var o,l,c,g=new ce,E={registerProvider:C,getProvider:f,setProvider:p};return E;function C(y){if(!Object.isExtensible(E))throw new Error("Cannot add provider to a frozen registry.");switch(!0){case a===y:break;case m(o):o=y;break;case o===y:break;case m(l):l=y;break;case l===y:break;default:c===void 0&&(c=new F),c.add(y);break}}function M(y,_){if(!m(o)){if(o.isProviderFor(y,_))return o;if(!m(l)){if(l.isProviderFor(y,_))return o;if(!m(c))for(var S=$e(c);;){var O=He(S);if(!O)return;var k=We(O);if(k.isProviderFor(y,_))return Ve(S),k}}}if(!m(a)&&a.isProviderFor(y,_))return a}function f(y,_){var S=g.get(y),O;return m(S)||(O=S.get(_)),m(O)&&(O=M(y,_),m(O)||(m(S)&&(S=new j,g.set(y,S)),S.set(_,O))),O}function h(y){if(m(y))throw new TypeError;return o===y||l===y||!m(c)&&c.has(y)}function p(y,_,S){if(!h(S))throw new Error("Metadata provider not registered.");var O=f(y,_);if(O!==S){if(!m(O))return!1;var k=g.get(y);m(k)&&(k=new j,g.set(y,k)),k.set(_,S)}return!0}}function Ot(){var a;return!m(W)&&P(r.Reflect)&&Object.isExtensible(r.Reflect)&&(a=r.Reflect[W]),m(a)&&(a=Et()),!m(W)&&P(r.Reflect)&&Object.isExtensible(r.Reflect)&&Object.defineProperty(r.Reflect,W,{enumerable:!1,configurable:!1,writable:!1,value:a}),a}function Pt(a){var o=new ce,l={isProviderFor:function(h,p){var y=o.get(h);return m(y)?!1:y.has(p)},OrdinaryDefineOwnMetadata:C,OrdinaryHasOwnMetadata:g,OrdinaryGetOwnMetadata:E,OrdinaryOwnMetadataKeys:M,OrdinaryDeleteMetadata:f};return Z.registerProvider(l),l;function c(h,p,y){var _=o.get(h),S=!1;if(m(_)){if(!y)return;_=new j,o.set(h,_),S=!0}var O=_.get(p);if(m(O)){if(!y)return;if(O=new j,_.set(p,O),!a.setProvider(h,p,l))throw _.delete(p),S&&o.delete(h),new Error("Wrong provider for target.")}return O}function g(h,p,y){var _=c(p,y,!1);return m(_)?!1:Be(_.has(h))}function E(h,p,y){var _=c(p,y,!1);if(!m(_))return _.get(h)}function C(h,p,y,_){var S=c(y,_,!0);S.set(h,p)}function M(h,p){var y=[],_=c(h,p,!1);if(m(_))return y;for(var S=_.keys(),O=$e(S),k=0;;){var Fe=He(O);if(!Fe)return y.length=k,y;var Dt=We(Fe);try{y[k]=Dt}catch(Gt){try{Ve(O)}finally{throw Gt}}k++}}function f(h,p,y){var _=c(p,y,!1);if(m(_)||!_.delete(h))return!1;if(_.size===0){var S=o.get(p);m(S)||(S.delete(y),S.size===0&&o.delete(S))}return!0}}function Ct(a){var o=a.defineMetadata,l=a.hasOwnMetadata,c=a.getOwnMetadata,g=a.getOwnMetadataKeys,E=a.deleteMetadata,C=new ce,M={isProviderFor:function(f,h){var p=C.get(f);return!m(p)&&p.has(h)?!0:g(f,h).length?(m(p)&&(p=new F,C.set(f,p)),p.add(h),!0):!1},OrdinaryDefineOwnMetadata:o,OrdinaryHasOwnMetadata:l,OrdinaryGetOwnMetadata:c,OrdinaryOwnMetadataKeys:g,OrdinaryDeleteMetadata:E};return M}function Y(a,o,l){var c=Z.getProvider(a,o);if(!m(c))return c;if(l){if(Z.setProvider(a,o,Ce))return Ce;throw new Error("Illegal state.")}}function Rt(){var a={},o=[],l=function(){function M(f,h,p){this._index=0,this._keys=f,this._values=h,this._selector=p}return M.prototype["@@iterator"]=function(){return this},M.prototype[u]=function(){return this},M.prototype.next=function(){var f=this._index;if(f>=0&&f<this._keys.length){var h=this._selector(this._keys[f],this._values[f]);return f+1>=this._keys.length?(this._index=-1,this._keys=o,this._values=o):this._index++,{value:h,done:!1}}return{value:void 0,done:!0}},M.prototype.throw=function(f){throw this._index>=0&&(this._index=-1,this._keys=o,this._values=o),f},M.prototype.return=function(f){return this._index>=0&&(this._index=-1,this._keys=o,this._values=o),{value:f,done:!0}},M}(),c=function(){function M(){this._keys=[],this._values=[],this._cacheKey=a,this._cacheIndex=-2}return Object.defineProperty(M.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),M.prototype.has=function(f){return this._find(f,!1)>=0},M.prototype.get=function(f){var h=this._find(f,!1);return h>=0?this._values[h]:void 0},M.prototype.set=function(f,h){var p=this._find(f,!0);return this._values[p]=h,this},M.prototype.delete=function(f){var h=this._find(f,!1);if(h>=0){for(var p=this._keys.length,y=h+1;y<p;y++)this._keys[y-1]=this._keys[y],this._values[y-1]=this._values[y];return this._keys.length--,this._values.length--,he(f,this._cacheKey)&&(this._cacheKey=a,this._cacheIndex=-2),!0}return!1},M.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=a,this._cacheIndex=-2},M.prototype.keys=function(){return new l(this._keys,this._values,g)},M.prototype.values=function(){return new l(this._keys,this._values,E)},M.prototype.entries=function(){return new l(this._keys,this._values,C)},M.prototype["@@iterator"]=function(){return this.entries()},M.prototype[u]=function(){return this.entries()},M.prototype._find=function(f,h){if(!he(this._cacheKey,f)){this._cacheIndex=-1;for(var p=0;p<this._keys.length;p++)if(he(this._keys[p],f)){this._cacheIndex=p;break}}return this._cacheIndex<0&&h&&(this._cacheIndex=this._keys.length,this._keys.push(f),this._values.push(void 0)),this._cacheIndex},M}();return c;function g(M,f){return M}function E(M,f){return f}function C(M,f){return[M,f]}}function It(){var a=function(){function o(){this._map=new j}return Object.defineProperty(o.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),o.prototype.has=function(l){return this._map.has(l)},o.prototype.add=function(l){return this._map.set(l,l),this},o.prototype.delete=function(l){return this._map.delete(l)},o.prototype.clear=function(){this._map.clear()},o.prototype.keys=function(){return this._map.keys()},o.prototype.values=function(){return this._map.keys()},o.prototype.entries=function(){return this._map.entries()},o.prototype["@@iterator"]=function(){return this.keys()},o.prototype[u]=function(){return this.keys()},o}();return a}function At(){var a=16,o=x.create(),l=c();return function(){function f(){this._key=c()}return f.prototype.has=function(h){var p=g(h,!1);return p!==void 0?x.has(p,this._key):!1},f.prototype.get=function(h){var p=g(h,!1);return p!==void 0?x.get(p,this._key):void 0},f.prototype.set=function(h,p){var y=g(h,!0);return y[this._key]=p,this},f.prototype.delete=function(h){var p=g(h,!1);return p!==void 0?delete p[this._key]:!1},f.prototype.clear=function(){this._key=c()},f}();function c(){var f;do f="@@WeakMap@@"+M();while(x.has(o,f));return o[f]=!0,f}function g(f,h){if(!i.call(f,l)){if(!h)return;Object.defineProperty(f,l,{value:x.create()})}return f[l]}function E(f,h){for(var p=0;p<h;++p)f[p]=Math.random()*255|0;return f}function C(f){if(typeof Uint8Array=="function"){var h=new Uint8Array(f);return typeof crypto<"u"?crypto.getRandomValues(h):typeof msCrypto<"u"?msCrypto.getRandomValues(h):E(h,f),h}return E(new Array(f),f)}function M(){var f=C(a);f[6]=f[6]&79|64,f[8]=f[8]&191|128;for(var h="",p=0;p<a;++p){var y=f[p];(p===4||p===6||p===8)&&(h+="-"),y<16&&(h+="0"),h+=y.toString(16).toLowerCase()}return h}}function pe(a){return a.__=void 0,delete a.__,a}})})(ze||(ze={}));var ge;(function(t){t[t.Transient=0]="Transient",t[t.Singleton=1]="Singleton",t[t.ResolutionScoped=2]="ResolutionScoped",t[t.ContainerScoped=3]="ContainerScoped"})(ge||(ge={}));const A=ge;/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var we=function(t,e){return we=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)i.hasOwnProperty(n)&&(r[n]=i[n])},we(t,e)};function Oe(t,e){we(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}function Bt(t,e,r,i){function n(s){return s instanceof r?s:new r(function(u){u(s)})}return new(r||(r=Promise))(function(s,u){function w(x){try{d(i.next(x))}catch(R){u(R)}}function T(x){try{d(i.throw(x))}catch(R){u(R)}}function d(x){x.done?s(x.value):n(x.value).then(w,T)}d((i=i.apply(t,[])).next())})}function Ut(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},i,n,s,u;return u={next:w(0),throw:w(1),return:w(2)},typeof Symbol=="function"&&(u[Symbol.iterator]=function(){return this}),u;function w(d){return function(x){return T([d,x])}}function T(d){if(i)throw new TypeError("Generator is already executing.");for(;r;)try{if(i=1,n&&(s=d[0]&2?n.return:d[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,d[1])).done)return s;switch(n=0,s&&(d=[d[0]&2,s.value]),d[0]){case 0:case 1:s=d;break;case 4:return r.label++,{value:d[1],done:!1};case 5:r.label++,n=d[1],d=[0];continue;case 7:d=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(d[0]===6||d[0]===2)){r=0;continue}if(d[0]===3&&(!s||d[1]>s[0]&&d[1]<s[3])){r.label=d[1];break}if(d[0]===6&&r.label<s[1]){r.label=s[1],s=d;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(d);break}s[2]&&r.ops.pop(),r.trys.pop();continue}d=e.call(t,r)}catch(x){d=[6,x],n=0}finally{i=s=0}if(d[0]&5)throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}}function K(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],i=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function ie(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var i=r.call(t),n,s=[],u;try{for(;(e===void 0||e-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(w){u={error:w}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(u)throw u.error}}return s}function $(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(ie(arguments[e]));return t}var me="injectionTokens";function Nt(t){var e=Reflect.getMetadata("design:paramtypes",t)||[],r=Reflect.getOwnMetadata(me,t)||{};return Object.keys(r).forEach(function(i){e[+i]=r[i]}),e}function jt(t,e){return function(r,i,n){var s=Reflect.getOwnMetadata(me,r)||{};s[n]=t,Reflect.defineMetadata(me,s,r)}}function rt(t){return!!t.useClass}function Te(t){return!!t.useFactory}var nt=function(){function t(e){this.wrap=e,this.reflectMethods=["get","getPrototypeOf","setPrototypeOf","getOwnPropertyDescriptor","defineProperty","has","set","deleteProperty","apply","construct","ownKeys"]}return t.prototype.createProxy=function(e){var r=this,i={},n=!1,s,u=function(){return n||(s=e(r.wrap()),n=!0),s};return new Proxy(i,this.createHandler(u))},t.prototype.createHandler=function(e){var r={},i=function(n){r[n]=function(){for(var s=[],u=0;u<arguments.length;u++)s[u]=arguments[u];s[0]=e();var w=Reflect[n];return w.apply(void 0,$(s))}};return this.reflectMethods.forEach(i),r},t}();function V(t){return typeof t=="string"||typeof t=="symbol"}function $t(t){return typeof t=="object"&&"token"in t&&"multiple"in t}function qe(t){return typeof t=="object"&&"token"in t&&"transform"in t}function Wt(t){return typeof t=="function"||t instanceof nt}function re(t){return!!t.useToken}function ne(t){return t.useValue!=null}function Ht(t){return rt(t)||ne(t)||re(t)||Te(t)}var Pe=function(){function t(){this._registryMap=new Map}return t.prototype.entries=function(){return this._registryMap.entries()},t.prototype.getAll=function(e){return this.ensure(e),this._registryMap.get(e)},t.prototype.get=function(e){this.ensure(e);var r=this._registryMap.get(e);return r[r.length-1]||null},t.prototype.set=function(e,r){this.ensure(e),this._registryMap.get(e).push(r)},t.prototype.setAll=function(e,r){this._registryMap.set(e,r)},t.prototype.has=function(e){return this.ensure(e),this._registryMap.get(e).length>0},t.prototype.clear=function(){this._registryMap.clear()},t.prototype.ensure=function(e){this._registryMap.has(e)||this._registryMap.set(e,[])},t}(),Vt=function(t){Oe(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e}(Pe),ee=function(){function t(){this.scopedResolutions=new Map}return t}();function Ft(t,e){if(t===null)return"at position #"+e;var r=t.split(",")[e].trim();return'"'+r+'" at position #'+e}function Yt(t,e,r){return r===void 0&&(r="    "),$([t],e.message.split(`
`).map(function(i){return r+i})).join(`
`)}function zt(t,e,r){var i=ie(t.toString().match(/constructor\(([\w, ]+)\)/)||[],2),n=i[1],s=n===void 0?null:n,u=Ft(s,e);return Yt("Cannot inject the dependency "+u+' of "'+t.name+'" constructor. Reason:',r)}function qt(t){if(typeof t.dispose!="function")return!1;var e=t.dispose;return!(e.length>0)}var Qt=function(t){Oe(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e}(Pe),Xt=function(t){Oe(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e}(Pe),Zt=function(){function t(){this.preResolution=new Qt,this.postResolution=new Xt}return t}(),it=new Map,Jt=function(){function t(e){this.parent=e,this._registry=new Vt,this.interceptors=new Zt,this.disposed=!1,this.disposables=new Set}return t.prototype.register=function(e,r,i){i===void 0&&(i={lifecycle:A.Transient}),this.ensureNotDisposed();var n;if(Ht(r)?n=r:n={useClass:r},re(n))for(var s=[e],u=n;u!=null;){var w=u.useToken;if(s.includes(w))throw new Error("Token registration cycle detected! "+$(s,[w]).join(" -> "));s.push(w);var T=this._registry.get(w);T&&re(T.provider)?u=T.provider:u=null}if((i.lifecycle===A.Singleton||i.lifecycle==A.ContainerScoped||i.lifecycle==A.ResolutionScoped)&&(ne(n)||Te(n)))throw new Error('Cannot use lifecycle "'+A[i.lifecycle]+'" with ValueProviders or FactoryProviders');return this._registry.set(e,{provider:n,options:i}),this},t.prototype.registerType=function(e,r){return this.ensureNotDisposed(),V(r)?this.register(e,{useToken:r}):this.register(e,{useClass:r})},t.prototype.registerInstance=function(e,r){return this.ensureNotDisposed(),this.register(e,{useValue:r})},t.prototype.registerSingleton=function(e,r){if(this.ensureNotDisposed(),V(e)){if(V(r))return this.register(e,{useToken:r},{lifecycle:A.Singleton});if(r)return this.register(e,{useClass:r},{lifecycle:A.Singleton});throw new Error('Cannot register a type name as a singleton without a "to" token')}var i=e;return r&&!V(r)&&(i=r),this.register(e,{useClass:i},{lifecycle:A.Singleton})},t.prototype.resolve=function(e,r,i){r===void 0&&(r=new ee),i===void 0&&(i=!1),this.ensureNotDisposed();var n=this.getRegistration(e);if(!n&&V(e)){if(i)return;throw new Error('Attempted to resolve unregistered dependency token: "'+e.toString()+'"')}if(this.executePreResolutionInterceptor(e,"Single"),n){var s=this.resolveRegistration(n,r);return this.executePostResolutionInterceptor(e,s,"Single"),s}if(Wt(e)){var s=this.construct(e,r);return this.executePostResolutionInterceptor(e,s,"Single"),s}throw new Error("Attempted to construct an undefined constructor. Could mean a circular dependency problem. Try using `delay` function.")},t.prototype.executePreResolutionInterceptor=function(e,r){var i,n;if(this.interceptors.preResolution.has(e)){var s=[];try{for(var u=K(this.interceptors.preResolution.getAll(e)),w=u.next();!w.done;w=u.next()){var T=w.value;T.options.frequency!="Once"&&s.push(T),T.callback(e,r)}}catch(d){i={error:d}}finally{try{w&&!w.done&&(n=u.return)&&n.call(u)}finally{if(i)throw i.error}}this.interceptors.preResolution.setAll(e,s)}},t.prototype.executePostResolutionInterceptor=function(e,r,i){var n,s;if(this.interceptors.postResolution.has(e)){var u=[];try{for(var w=K(this.interceptors.postResolution.getAll(e)),T=w.next();!T.done;T=w.next()){var d=T.value;d.options.frequency!="Once"&&u.push(d),d.callback(e,r,i)}}catch(x){n={error:x}}finally{try{T&&!T.done&&(s=w.return)&&s.call(w)}finally{if(n)throw n.error}}this.interceptors.postResolution.setAll(e,u)}},t.prototype.resolveRegistration=function(e,r){if(this.ensureNotDisposed(),e.options.lifecycle===A.ResolutionScoped&&r.scopedResolutions.has(e))return r.scopedResolutions.get(e);var i=e.options.lifecycle===A.Singleton,n=e.options.lifecycle===A.ContainerScoped,s=i||n,u;return ne(e.provider)?u=e.provider.useValue:re(e.provider)?u=s?e.instance||(e.instance=this.resolve(e.provider.useToken,r)):this.resolve(e.provider.useToken,r):rt(e.provider)?u=s?e.instance||(e.instance=this.construct(e.provider.useClass,r)):this.construct(e.provider.useClass,r):Te(e.provider)?u=e.provider.useFactory(this):u=this.construct(e.provider,r),e.options.lifecycle===A.ResolutionScoped&&r.scopedResolutions.set(e,u),u},t.prototype.resolveAll=function(e,r,i){var n=this;r===void 0&&(r=new ee),i===void 0&&(i=!1),this.ensureNotDisposed();var s=this.getAllRegistrations(e);if(!s&&V(e)){if(i)return[];throw new Error('Attempted to resolve unregistered dependency token: "'+e.toString()+'"')}if(this.executePreResolutionInterceptor(e,"All"),s){var u=s.map(function(T){return n.resolveRegistration(T,r)});return this.executePostResolutionInterceptor(e,u,"All"),u}var w=[this.construct(e,r)];return this.executePostResolutionInterceptor(e,w,"All"),w},t.prototype.isRegistered=function(e,r){return r===void 0&&(r=!1),this.ensureNotDisposed(),this._registry.has(e)||r&&(this.parent||!1)&&this.parent.isRegistered(e,!0)},t.prototype.reset=function(){this.ensureNotDisposed(),this._registry.clear(),this.interceptors.preResolution.clear(),this.interceptors.postResolution.clear()},t.prototype.clearInstances=function(){var e,r;this.ensureNotDisposed();try{for(var i=K(this._registry.entries()),n=i.next();!n.done;n=i.next()){var s=ie(n.value,2),u=s[0],w=s[1];this._registry.setAll(u,w.filter(function(T){return!ne(T.provider)}).map(function(T){return T.instance=void 0,T}))}}catch(T){e={error:T}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(e)throw e.error}}},t.prototype.createChildContainer=function(){var e,r;this.ensureNotDisposed();var i=new t(this);try{for(var n=K(this._registry.entries()),s=n.next();!s.done;s=n.next()){var u=ie(s.value,2),w=u[0],T=u[1];T.some(function(d){var x=d.options;return x.lifecycle===A.ContainerScoped})&&i._registry.setAll(w,T.map(function(d){return d.options.lifecycle===A.ContainerScoped?{provider:d.provider,options:d.options}:d}))}}catch(d){e={error:d}}finally{try{s&&!s.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}return i},t.prototype.beforeResolution=function(e,r,i){i===void 0&&(i={frequency:"Always"}),this.interceptors.preResolution.set(e,{callback:r,options:i})},t.prototype.afterResolution=function(e,r,i){i===void 0&&(i={frequency:"Always"}),this.interceptors.postResolution.set(e,{callback:r,options:i})},t.prototype.dispose=function(){return Bt(this,void 0,void 0,function(){var e;return Ut(this,function(r){switch(r.label){case 0:return this.disposed=!0,e=[],this.disposables.forEach(function(i){var n=i.dispose();n&&e.push(n)}),[4,Promise.all(e)];case 1:return r.sent(),[2]}})})},t.prototype.getRegistration=function(e){return this.isRegistered(e)?this._registry.get(e):this.parent?this.parent.getRegistration(e):null},t.prototype.getAllRegistrations=function(e){return this.isRegistered(e)?this._registry.getAll(e):this.parent?this.parent.getAllRegistrations(e):null},t.prototype.construct=function(e,r){var i=this;if(e instanceof nt)return e.createProxy(function(s){return i.resolve(s,r)});var n=function(){var s=it.get(e);if(!s||s.length===0){if(e.length===0)return new e;throw new Error('TypeInfo not known for "'+e.name+'"')}var u=s.map(i.resolveParams(r,e));return new(e.bind.apply(e,$([void 0],u)))}();return qt(n)&&this.disposables.add(n),n},t.prototype.resolveParams=function(e,r){var i=this;return function(n,s){var u,w,T;try{return $t(n)?qe(n)?n.multiple?(u=i.resolve(n.transform)).transform.apply(u,$([i.resolveAll(n.token,new ee,n.isOptional)],n.transformArgs)):(w=i.resolve(n.transform)).transform.apply(w,$([i.resolve(n.token,e,n.isOptional)],n.transformArgs)):n.multiple?i.resolveAll(n.token,new ee,n.isOptional):i.resolve(n.token,e,n.isOptional):qe(n)?(T=i.resolve(n.transform,e)).transform.apply(T,$([i.resolve(n.token,e)],n.transformArgs)):i.resolve(n,e)}catch(d){throw new Error(zt(r,s,d))}}},t.prototype.ensureNotDisposed=function(){if(this.disposed)throw new Error("This container has been disposed, you cannot interact with a disposed container")},t}(),D=new Jt;function U(t,e){var r={token:t,multiple:!1,isOptional:e};return jt(r)}function N(t){return function(e){it.set(e,Nt(e))}}function st(){return function(t){N()(t),D.registerSingleton(t)}}if(typeof Reflect>"u"||!Reflect.getMetadata)throw new Error(`tsyringe requires a reflect polyfill. Please add 'import "reflect-metadata"' to the top of your entry point.`);const Qe=t=>{let e;const r=new Set,i=(d,x)=>{const R=typeof d=="function"?d(e):d;if(!Object.is(R,e)){const j=e;e=x??(typeof R!="object"||R===null)?R:Object.assign({},e,R),r.forEach(F=>F(e,j))}},n=()=>e,w={setState:i,getState:n,getInitialState:()=>T,subscribe:d=>(r.add(d),()=>r.delete(d))},T=e=t(i,n,w);return w},Kt=t=>t?Qe(t):Qe,b=64,z=8,q=10,er=4473924,te=2236962,tr=4500036,Xe=5592439,rr=16711680,nr=35071,at=100,Me=150,ot=1,Ze=200,ve=1e3,ir=16776960,sr=400,X=25,Je=50,ut=25,ar=150,or=10,Ke=10,I=Kt(t=>({money:ar,lives:or,level:1,wave:0,gameOver:!1,actions:{spendMoney:e=>t(r=>({money:r.money-e})),earnMoney:e=>t(r=>({money:r.money+e})),loseLife:()=>t(e=>({lives:e.lives-1})),setWave:e=>t({wave:e}),setLevel:e=>t({level:e}),setGameOver:e=>t({gameOver:e})}}));var ur=Object.getOwnPropertyDescriptor,lr=(t,e,r,i)=>{for(var n=i>1?void 0:i?ur(e,r):e,s=t.length-1,u;s>=0;s--)(u=t[s])&&(n=u(n)||n);return n},et=(t,e)=>(r,i)=>e(r,i,t);let _e=class{constructor(t,e){v(this,"scene");v(this,"logicGrid",[]);v(this,"graphicsGrid",[]);this.turretManager=t,this.uiManager=e}setScene(t){this.scene=t,this.initializeGrid(),this.drawGrid()}handleTileClick(t,e){const r=this.logicGrid[e][t],i=this.getTileCenter(t,e);if(r===1){this.uiManager.hideTurretUI();return}if(r===2){const u=this.turretManager.getTurretAt(i.x,i.y);u&&this.uiManager.showTurretUI(u);return}const{money:n,actions:s}=I.getState();n>=Je?(this.turretManager.placeTurret(i.x,i.y,this.uiManager.getSelectedTurretType()),this.logicGrid[e][t]=2,s.spendMoney(Je),this.uiManager.hideTurretUI()):(console.log("Not enough cash!"),this.graphicsGrid[e][t].setFillStyle(16711680),this.scene.time.delayedCall(200,()=>{this.graphicsGrid[e][t].setFillStyle(te)}))}getTileCenter(t,e){const r=(this.scene.scale.width-q*b)/2,i=(this.scene.scale.height-z*b)/2;return{x:r+t*b+b/2,y:i+e*b+b/2}}initializeGrid(){for(let t=0;t<z;t++){this.logicGrid[t]=[],this.graphicsGrid[t]=[];for(let e=0;e<q;e++)this.logicGrid[t][e]=0}}drawGrid(){const t=(this.scene.scale.width-q*b)/2,e=(this.scene.scale.height-z*b)/2;for(let r=0;r<z;r++)for(let i=0;i<q;i++){const n=t+i*b,s=e+r*b,u=this.scene.add.rectangle(n,s,b,b,te).setOrigin(0,0).setStrokeStyle(1,er).setInteractive();this.graphicsGrid[r][i]=u,u.on("pointerover",()=>{this.logicGrid[r][i]===0&&u.setFillStyle(tr)}),u.on("pointerout",()=>{this.logicGrid[r][i]===0?u.setFillStyle(te):this.logicGrid[r][i]===1&&u.setFillStyle(Xe)}),u.on("pointerdown",()=>this.handleTileClick(i,r))}}setupPath(t){t.forEach(e=>{this.graphicsGrid[e.y]&&this.graphicsGrid[e.y][e.x]&&(this.logicGrid[e.y][e.x]=1,this.graphicsGrid[e.y][e.x].setFillStyle(Xe))})}clearGrid(){for(let t=0;t<z;t++)for(let e=0;e<q;e++)this.logicGrid[t][e]=0,this.graphicsGrid[t]&&this.graphicsGrid[t][e]&&this.graphicsGrid[t][e].setFillStyle(te)}};_e=lr([N(),et(0,U("TurretManager")),et(1,U("UIManager"))],_e);const cr=[{path:[{x:0,y:2},{x:1,y:2},{x:2,y:2},{x:2,y:3},{x:2,y:4},{x:3,y:4},{x:4,y:4},{x:5,y:4},{x:5,y:3},{x:5,y:2},{x:5,y:1},{x:6,y:1},{x:7,y:1},{x:8,y:1},{x:9,y:1}],waves:[{enemyCount:5,spawnDelay:1e3},{enemyCount:8,spawnDelay:800},{enemyCount:10,spawnDelay:500}]},{path:[{x:0,y:4},{x:1,y:4},{x:2,y:4},{x:2,y:3},{x:2,y:2},{x:3,y:2},{x:4,y:2},{x:5,y:2},{x:6,y:2},{x:7,y:2},{x:7,y:3},{x:7,y:4},{x:7,y:5},{x:8,y:5},{x:9,y:5}],waves:[{enemyCount:10,spawnDelay:1e3},{enemyCount:15,spawnDelay:700},{enemyCount:20,spawnDelay:400}]}];var fr=Object.getOwnPropertyDescriptor,hr=(t,e,r,i)=>{for(var n=i>1?void 0:i?fr(e,r):e,s=t.length-1,u;s>=0;s--)(u=t[s])&&(n=u(n)||n);return n};let xe=class{constructor(){v(this,"levels");this.levels=cr}setScene(t){}getLevel(t){return this.levels[t]}getTotalLevels(){return this.levels.length}};xe=hr([N()],xe);var L=(t=>(t[t.QUICK=0]="QUICK",t[t.HEAVY=1]="HEAVY",t[t.SPLASH=2]="SPLASH",t))(L||{});class ye extends G.GameObjects.Sprite{constructor(r,i,n,s,u,w){super(r,i,n,"turretTexture");v(this,"level",1);v(this,"damage",X);v(this,"range",Ze);v(this,"fireRate",ve);v(this,"turretType");v(this,"nextFire",0);v(this,"enemies");v(this,"bullets");switch(this.enemies=s,this.bullets=u,this.turretType=w,this.turretType){case L.QUICK:this.damage=X*.7,this.fireRate=ve/2;break;case L.HEAVY:this.damage=X*2,this.fireRate=ve*2;break;case L.SPLASH:this.damage=X*.9,this.range=Ze*.8;break}}initialize(){this.scene.add.existing(this)}update(r,i){if(r<this.nextFire)return;const n=this.findNearestEnemy();if(n){const s=G.Math.Angle.Between(this.x,this.y,n.x,n.y);this.setRotation(s),this.fireBullet(s),this.nextFire=r+this.fireRate}}upgrade(){this.level++,this.damage+=15,this.range+=20,this.fireRate=Math.max(100,this.fireRate-100)}findNearestEnemy(){let r=null,i=this.range;return this.enemies.getChildren().forEach(n=>{const s=n;if(s.active){const u=G.Math.Distance.Between(this.x,this.y,s.x,s.y);u<i&&(i=u,r=s)}}),r}fireBullet(r){const i=this.bullets.get(this.x,this.y);i&&i.fire(this.x,this.y,r,this.damage,this.turretType)}}class dr extends G.Physics.Arcade.Sprite{constructor(r,i,n){super(r,i,n,"bulletTexture");v(this,"damage",X);v(this,"turretType");r.add.existing(this),r.physics.add.existing(this)}fire(r,i,n,s,u){this.setPosition(r,i),this.setActive(!0),this.setVisible(!0),this.damage=s,this.turretType=u,this.scene.physics.velocityFromRotation(n,sr,this.body.velocity)}update(r,i){(this.x<0||this.x>800||this.y<0||this.y>600)&&(this.setActive(!1),this.setVisible(!1))}}var pr=Object.getOwnPropertyDescriptor,vr=(t,e,r,i)=>{for(var n=i>1?void 0:i?pr(e,r):e,s=t.length-1,u;s>=0;s--)(u=t[s])&&(n=u(n)||n);return n};let Se=class{constructor(){v(this,"scene");v(this,"turrets");v(this,"enemies");v(this,"bullets")}setScene(t){this.scene=t,this.turrets=this.scene.add.group({classType:ye,runChildUpdate:!0}),this.bullets=this.scene.physics.add.group({classType:dr,runChildUpdate:!0})}placeTurret(t,e,r){const i=new ye(this.scene,t,e,this.enemies,this.bullets,r);i.initialize(),this.turrets.add(i)}getBulletGroup(){return this.bullets}setEnemyGroup(t){this.enemies=t}getTurretAt(t,e){let r=null;return this.turrets.getChildren().forEach(i=>{const n=i;G.Math.Distance.Between(n.x,n.y,t,e)<1&&(r=n)}),r}upgradeTurret(t){t.upgrade();const e=this.scene.add.graphics();e.lineStyle(2,65280,1),e.strokeCircle(t.x,t.y,t.range),this.scene.time.delayedCall(200,()=>{e.destroy()})}clearTurrets(){this.turrets.clear(!0,!0),this.turrets=this.scene.add.group({classType:ye,runChildUpdate:!0})}};Se=vr([N()],Se);class tt extends G.Physics.Arcade.Sprite{constructor(r,i,n,s,u,w,T,d){super(r,i,n,"enemyTexture");v(this,"path",[]);v(this,"currentPointIndex",0);v(this,"moveSpeed",Me);v(this,"health",at);v(this,"defense",ot);v(this,"speed",Me);v(this,"gameManager");r.add.existing(this),r.physics.add.existing(this),this.path=s,this.currentPointIndex=0,this.health=u,this.speed=w,this.defense=T,this.moveSpeed=w,this.gameManager=d,this.moveToNextPoint()}moveToNextPoint(){if(this.currentPointIndex<this.path.length){const r=this.path[this.currentPointIndex];this.scene.physics.moveTo(this,r.x,r.y,this.moveSpeed)}else this.gameManager.onEnemyReachedEnd(this),this.destroy()}update(r,i){var u;if(!this.active)return;const n=this.path[this.currentPointIndex];G.Math.Distance.Between(this.x,this.y,n.x,n.y)<5&&(this.setPosition(n.x,n.y),(u=this.body)==null||u.reset(n.x,n.y),this.currentPointIndex++,this.moveToNextPoint())}takeDamage(r){const i=Math.max(1,r-this.defense);this.health-=i,this.health<=0?this.destroy():(this.setTint(16777215),this.scene.time.delayedCall(100,()=>{this.clearTint()}))}}var yr=Object.getOwnPropertyDescriptor,gr=(t,e,r,i)=>{for(var n=i>1?void 0:i?yr(e,r):e,s=t.length-1,u;s>=0;s--)(u=t[s])&&(n=u(n)||n);return n},wr=(t,e)=>(r,i)=>e(r,i,t);let be=class{constructor(t){v(this,"scene");v(this,"enemyGroup");v(this,"worldPath",[]);v(this,"spawnTimer");v(this,"enemiesToSpawn",0);v(this,"onWaveComplete");v(this,"isWaveActive",!1);v(this,"waveNumber",1);this.gridManager=t}setScene(t){this.scene=t,this.enemyGroup=this.scene.physics.add.group({classType:tt,runChildUpdate:!0})}convertGridPathToWorldPath(t){this.worldPath=t.map(e=>{const r=this.gridManager.getTileCenter(e.x,e.y);return new G.Math.Vector2(r.x,r.y)})}startWave(t,e,r,i){this.worldPath.length!==0&&(this.waveNumber=e,this.enemiesToSpawn=t.enemyCount,this.isWaveActive=!0,this.onWaveComplete=i,this.spawnTimer=this.scene.time.addEvent({delay:t.spawnDelay,callback:()=>this.spawnEnemy(r),callbackScope:this,repeat:this.enemiesToSpawn-1}))}spawnEnemy(t){if(this.worldPath.length===0)return;const e=this.worldPath[0],r=at+this.waveNumber*10,i=Me+this.waveNumber*2,n=ot+this.waveNumber*.5,s=new tt(this.scene,e.x,e.y,this.worldPath,r,i,n,t);this.enemyGroup.add(s)}getEnemyGroup(){return this.enemyGroup}update(){var t;this.isWaveActive&&((t=this.spawnTimer)==null?void 0:t.getOverallProgress())===1&&this.enemyGroup.countActive(!0)===0&&(this.isWaveActive=!1,this.onWaveComplete())}stopWave(){this.spawnTimer&&this.spawnTimer.remove(),this.enemyGroup.clear(!0,!0),this.isWaveActive=!1}};be=gr([N(),wr(0,U("GridManager"))],be);var mr=Object.getOwnPropertyDescriptor,Tr=(t,e,r,i)=>{for(var n=i>1?void 0:i?mr(e,r):e,s=t.length-1,u;s>=0;s--)(u=t[s])&&(n=u(n)||n);return n},Mr=(t,e)=>(r,i)=>e(r,i,t);let Ee=class{constructor(t){v(this,"scene");v(this,"errorHandler");v(this,"errorIcon");v(this,"errorPopup");v(this,"moneyText");v(this,"livesText");v(this,"levelText");v(this,"waveText");v(this,"turretUIContainer");v(this,"turretNameText");v(this,"turretStatsText");v(this,"upgradeButton");v(this,"newLevelButton");v(this,"startLevelButton");v(this,"selectedTurret",null);v(this,"selectedTurretType",L.QUICK);v(this,"quickTurretButton");v(this,"heavyTurretButton");v(this,"splashTurretButton");v(this,"upgradeTurretCallback");v(this,"nextLevelCallback");v(this,"startLevelCallback");this.errorHandler=t}setScene(t,e,r,i){this.scene=t,this.upgradeTurretCallback=e,this.nextLevelCallback=r,this.startLevelCallback=i,this.createUI(),this.createTurretUI(),this.createTurretSelectionUI(),this.createNewLevelButton(),this.createStartLevelButton(),this.createErrorUI(),I.subscribe(n=>{this.moneyText.setText(`Money: $${n.money}`),this.livesText.setText(`Lives: ${n.lives}`),this.levelText.setText(`Level: ${n.level}`),this.waveText.setText(`Wave: ${n.wave}`)})}createUI(){const t={font:"20px Arial",color:"#ffffff",stroke:"#000000",strokeThickness:2};this.moneyText=this.scene.add.text(10,10,"Money: 0",t),this.levelText=this.scene.add.text(10,40,"Level: 1",t),this.livesText=this.scene.add.text(790,10,"Lives: 0",t).setOrigin(1,0),this.waveText=this.scene.add.text(790,40,"Wave: 1",t).setOrigin(1,0)}createTurretUI(){this.turretUIContainer=this.scene.add.container(10,100),this.turretUIContainer.setVisible(!1);const t=this.scene.add.rectangle(0,0,180,150,0,.7).setOrigin(0);this.turretUIContainer.add(t),this.turretNameText=this.scene.add.text(10,10,"",{font:"18px Arial",color:"#ffffff"}),this.turretStatsText=this.scene.add.text(10,40,"",{font:"14px Arial",color:"#ffffff"}),this.upgradeButton=this.scene.add.text(90,120,"Upgrade",{font:"16px Arial",color:"#00ff00"}).setOrigin(.5,0).setInteractive().on("pointerdown",()=>{this.selectedTurret&&(this.upgradeTurretCallback(this.selectedTurret),this.updateTurretUI())}),this.turretUIContainer.add([this.turretNameText,this.turretStatsText,this.upgradeButton])}showTurretUI(t){this.selectedTurret=t,this.updateTurretUI(),this.turretUIContainer.setVisible(!0)}hideTurretUI(){this.selectedTurret=null,this.turretUIContainer.setVisible(!1)}updateTurretUI(){if(!this.selectedTurret)return;this.turretNameText.setText(`Turret (Lv ${this.selectedTurret.level})`),this.turretStatsText.setText(`Damage: ${this.selectedTurret.damage}
Range: ${this.selectedTurret.range}
Rate: ${1e3/this.selectedTurret.fireRate}/s`);const t=ut*this.selectedTurret.level;this.upgradeButton.setText(`Upgrade ($${t})`);const{money:e}=I.getState();e<t?this.upgradeButton.setColor("#ff0000").disableInteractive():this.upgradeButton.setColor("#00ff00").setInteractive()}createNewLevelButton(){this.newLevelButton=this.scene.add.text(400,300,"Start Next Level",{font:"32px Arial",color:"#00ff00",backgroundColor:"#000000",padding:{x:20,y:10}}).setOrigin(.5).setInteractive().on("pointerdown",()=>{this.nextLevelCallback()}),this.newLevelButton.setVisible(!1)}createStartLevelButton(){this.startLevelButton=this.scene.add.text(400,300,"Start Level",{font:"32px Arial",color:"#00ff00",backgroundColor:"#000000",padding:{x:20,y:10}}).setOrigin(.5).setInteractive().on("pointerdown",()=>{this.startLevelCallback()}),this.startLevelButton.setVisible(!1)}showNewLevelButton(){this.newLevelButton.setVisible(!0)}hideNewLevelButton(){this.newLevelButton.setVisible(!1)}showStartLevelButton(){this.startLevelButton.setVisible(!0)}hideStartLevelButton(){this.startLevelButton.setVisible(!1)}createTurretSelectionUI(){const t=this.scene.add.container(10,300);this.quickTurretButton=this.scene.add.text(0,0,"Build Quick Turret").setInteractive().on("pointerdown",()=>{this.selectedTurretType=L.QUICK,this.updateTurretButtonStyles()}),this.heavyTurretButton=this.scene.add.text(0,30,"Build Heavy Turret").setInteractive().on("pointerdown",()=>{this.selectedTurretType=L.HEAVY,this.updateTurretButtonStyles()}),this.splashTurretButton=this.scene.add.text(0,60,"Build Splash Turret").setInteractive().on("pointerdown",()=>{this.selectedTurretType=L.SPLASH,this.updateTurretButtonStyles()}),t.add([this.quickTurretButton,this.heavyTurretButton,this.splashTurretButton]),this.updateTurretButtonStyles()}updateTurretButtonStyles(){const t={font:"18px Arial",color:"#ffffff"},e={font:"18px Arial",color:"#00ff00"};this.quickTurretButton.setStyle(this.selectedTurretType===L.QUICK?e:t),this.heavyTurretButton.setStyle(this.selectedTurretType===L.HEAVY?e:t),this.splashTurretButton.setStyle(this.selectedTurretType===L.SPLASH?e:t)}getSelectedTurretType(){return this.selectedTurretType}createErrorUI(){this.errorIcon=this.scene.add.text(770,570,"ðŸž",{fontSize:"30px"}).setInteractive().setVisible(!1),this.errorPopup=this.scene.add.container(100,100).setVisible(!1);const t=this.scene.add.graphics();t.fillStyle(0,.8),t.fillRect(0,0,600,400),this.errorPopup.add(t);const e=this.scene.add.text(10,10,"",{fontSize:"16px",color:"#ffffff",wordWrap:{width:580}});this.errorPopup.add(e);const r=this.scene.add.text(590,10,"X",{fontSize:"20px",color:"#ffffff"}).setInteractive().setOrigin(1,0);this.errorPopup.add(r);const i=this.scene.add.text(500,370,"Copy",{fontSize:"20px",color:"#ffffff"}).setInteractive();this.errorPopup.add(i),this.errorIcon.on("pointerdown",()=>{e.setText(this.getFormattedErrors()),this.errorPopup.setVisible(!0)}),r.on("pointerdown",()=>{this.errorPopup.setVisible(!1)}),i.on("pointerdown",()=>{navigator.clipboard.writeText(this.getFormattedErrors())})}getFormattedErrors(){return this.errorHandler.getErrors().map(e=>`${e.message}
${e.stack}`).join(`

`)}update(){this.errorHandler.getErrors().length>0&&this.errorIcon.setVisible(!0)}showGameOver(){this.scene.add.text(400,300,"Game Over",{font:"48px Arial",color:"#ff0000",backgroundColor:"#000000",padding:{x:20,y:10}}).setOrigin(.5)}};Ee=Tr([N(),Mr(0,U("ErrorHandler"))],Ee);var _r=Object.getOwnPropertyDescriptor,xr=(t,e,r,i)=>{for(var n=i>1?void 0:i?_r(e,r):e,s=t.length-1,u;s>=0;s--)(u=t[s])&&(n=u(n)||n);return n},Q=(t,e)=>(r,i)=>e(r,i,t);let se=class{constructor(t,e,r,i,n){v(this,"scene");this.levelManager=t,this.waveManager=e,this.turretManager=r,this.gridManager=i,this.uiManager=n}setScene(t){this.scene=t}initialize(){this.setupPhysics(),I.subscribe(t=>{t.lives<=0&&this.gameOver()})}gameOver(){const{actions:t}=I.getState();t.setGameOver(!0),this.waveManager.stopWave(),this.uiManager.showGameOver()}update(t,e){const{gameOver:r}=I.getState();r||this.waveManager.update()}startCurrentLevel(){this.uiManager.hideStartLevelButton();const{level:t,actions:e}=I.getState(),r=this.levelManager.getLevel(t-1);r?(e.setLevel(t),this.gridManager.setupPath(r.path),this.waveManager.convertGridPathToWorldPath(r.path),this.turretManager.setEnemyGroup(this.waveManager.getEnemyGroup()),this.startWave()):console.log("YOU WON!")}startWave(){const{level:t,wave:e,actions:r}=I.getState(),i=this.levelManager.getLevel(t-1),n=i==null?void 0:i.waves[e];n&&(r.setWave(e+1),this.waveManager.startWave(n,e+1,this,this.onWaveComplete.bind(this)))}onWaveComplete(){const{level:t,wave:e}=I.getState(),r=this.levelManager.getLevel(t-1);r&&e<r.waves.length?this.startWave():this.uiManager.showNewLevelButton()}nextLevel(){const{level:t,actions:e}=I.getState();e.setLevel(t+1),e.setWave(0),this.turretManager.clearTurrets(),this.gridManager.clearGrid(),this.startCurrentLevel(),this.uiManager.hideNewLevelButton()}setupPhysics(){this.scene.physics.add.overlap(this.turretManager.getBulletGroup(),this.waveManager.getEnemyGroup(),(t,e)=>this.handleBulletHit(t,e))}handleBulletHit(t,e){if(t.setActive(!1),t.setVisible(!1),e.takeDamage(t.damage),t.turretType===L.SPLASH&&this.waveManager.getEnemyGroup().getChildren().forEach(i=>{const n=i;if(n.active&&n!==e&&Phaser.Math.Distance.Between(e.x,e.y,n.x,n.y)<=50&&(n.takeDamage(t.damage*.5),!n.active)){const{actions:s}=I.getState();s.earnMoney(Ke)}}),!e.active){const{actions:r}=I.getState();r.earnMoney(Ke)}}onEnemyReachedEnd(t){const{actions:e}=I.getState();e.loseLife(),t.destroy(),this.checkGameOver()}checkGameOver(){const{lives:t,actions:e}=I.getState();t<=0&&(e.setGameOver(!0),this.scene.physics.pause(),this.waveManager.stopWave(),this.uiManager.showGameOver())}upgradeTurret(t){const{money:e,actions:r}=I.getState(),i=ut*t.level;e>=i&&(r.spendMoney(i),this.turretManager.upgradeTurret(t))}};se=xr([N(),Q(0,U("LevelManager")),Q(1,U("WaveManager")),Q(2,U("TurretManager")),Q(3,U("GridManager")),Q(4,U("UIManager"))],se);var Sr=Object.getOwnPropertyDescriptor,br=(t,e,r,i)=>{for(var n=i>1?void 0:i?Sr(e,r):e,s=t.length-1,u;s>=0;s--)(u=t[s])&&(n=u(n)||n);return n};let ae=class{preload(t){this.createTurretTexture(t),this.createEnemyTexture(t),this.createBulletTexture(t)}createTurretTexture(t){const e="turretTexture";if(!t.textures.exists(e)){const r=t.make.graphics();r.fillStyle(nr,1),r.fillCircle(b/2,b/2,b*.4),r.fillStyle(16777215,1),r.fillRect(b/2,b/2-5,b*.4,10),r.generateTexture(e,b,b)}}createEnemyTexture(t){const e="enemyTexture";if(!t.textures.exists(e)){const r=t.make.graphics();r.fillStyle(rr,1),r.fillRect(0,0,b*.6,b*.6),r.generateTexture(e,b*.6,b*.6)}}createBulletTexture(t){const e="bulletTexture";if(!t.textures.exists(e)){const r=t.make.graphics();r.fillStyle(ir,1),r.fillCircle(4,4,4),r.generateTexture(e,8,8)}}};ae=br([N()],ae);var Er=Object.getOwnPropertyDescriptor,Or=(t,e,r,i)=>{for(var n=i>1?void 0:i?Er(e,r):e,s=t.length-1,u;s>=0;s--)(u=t[s])&&(n=u(n)||n);return n},Pr=(t,e)=>(r,i)=>e(r,i,t);let oe=class{constructor(t){v(this,"errors",[]);this.errorDisplay=t}addError(t){console.error(t);const e={message:t.message,stack:t.stack};this.errors.push(e),this.errorDisplay.addError(e)}getErrors(){return this.errors}clearErrors(){this.errors=[],this.errorDisplay.clearErrors()}};oe=Or([st(),Pr(0,U("ErrorDisplay"))],oe);var Cr=Object.getOwnPropertyDescriptor,Rr=(t,e,r,i)=>{for(var n=i>1?void 0:i?Cr(e,r):e,s=t.length-1,u;s>=0;s--)(u=t[s])&&(n=u(n)||n);return n};let ue=class{constructor(){v(this,"errorList");const t=document.createElement("div");t.id="error-container",document.body.appendChild(t),this.errorList=document.createElement("ul"),t.appendChild(this.errorList)}addError(t){const e=document.createElement("li");e.innerHTML=`<strong>${t.message}</strong><br><pre>${t.stack}</pre>`,this.errorList.appendChild(e)}clearErrors(){this.errorList.innerHTML=""}};ue=Rr([st()],ue);D.registerSingleton("AssetsManager",ae);D.registerSingleton("ErrorDisplay",ue);D.registerSingleton("ErrorHandler",oe);D.registerSingleton("GridManager",_e);D.registerSingleton("LevelManager",xe);D.registerSingleton("TurretManager",Se);D.registerSingleton("WaveManager",be);D.registerSingleton("UIManager",Ee);D.registerSingleton("GameManager",se);class Ir extends G.Scene{constructor(){super("GameScene");v(this,"gameManager");v(this,"assetsManager")}preload(){this.assetsManager=D.resolve(ae),this.assetsManager.preload(this)}create(){this.gameManager=D.resolve(se),this.gameManager.setScene(this),this.gameManager.gridManager.setScene(this),this.gameManager.waveManager.setScene(this),this.gameManager.turretManager.setScene(this),this.gameManager.levelManager.setScene(this),this.gameManager.uiManager.setScene(this,this.gameManager.upgradeTurret.bind(this.gameManager),this.gameManager.nextLevel.bind(this.gameManager),this.gameManager.startCurrentLevel.bind(this.gameManager)),this.gameManager.initialize(),this.gameManager.uiManager.showStartLevelButton()}update(r,i){this.gameManager.update(r,i),this.gameManager.uiManager.update()}}D.resolve(ue);const le=D.resolve(oe);window.onerror=(t,e,r,i,n)=>{if(n)le.addError(n);else{const s=new Error(`Unhandled error: ${t} at ${e}:${r}:${i}`);le.addError(s)}return!0};window.addEventListener("unhandledrejection",t=>{if(t.reason instanceof Error)le.addError(t.reason);else{const e=new Error(`Unhandled promise rejection: ${t.reason}`);le.addError(e)}});const Ar={type:G.AUTO,width:800,height:600,scale:{mode:G.Scale.FIT,autoCenter:G.Scale.CENTER_BOTH},parent:"app",physics:{default:"arcade",arcade:{gravity:{x:0,y:0},debug:!0}},scene:[Ir],backgroundColor:"#2d2d2d"};window.onload=()=>{new G.Game(Ar)};
