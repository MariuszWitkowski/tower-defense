import{c as We,P as I}from"./phaser-D9yEWc94.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const l of s.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function r(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=r(i);fetch(i.href,s)}})();var $e={};var Ye;function Gt(){if(Ye)return $e;Ye=1;var t;return(function(e){(function(r){var n=typeof globalThis=="object"?globalThis:typeof We=="object"?We:typeof self=="object"?self:typeof this=="object"?this:m(),i=s(e);typeof n.Reflect<"u"&&(i=s(n.Reflect,i)),r(i,n),typeof n.Reflect>"u"&&(n.Reflect=e);function s(d,x){return function(b,F){Object.defineProperty(d,b,{configurable:!0,writable:!0,value:F}),x&&x(b,F)}}function l(){try{return Function("return this;")()}catch{}}function g(){try{return(0,eval)("(function() { return this; })()")}catch{}}function m(){return l()||g()}})(function(r,n){var i=Object.prototype.hasOwnProperty,s=typeof Symbol=="function",l=s&&typeof Symbol.toPrimitive<"u"?Symbol.toPrimitive:"@@toPrimitive",g=s&&typeof Symbol.iterator<"u"?Symbol.iterator:"@@iterator",m=typeof Object.create=="function",d={__proto__:[]}instanceof Array,x=!m&&!d,b={create:m?function(){return pe(Object.create(null))}:d?function(){return pe({__proto__:null})}:function(){return pe({})},has:x?function(a,o){return i.call(a,o)}:function(a,o){return o in a},get:x?function(a,o){return i.call(a,o)?a[o]:void 0}:function(a,o){return a[o]}},F=Object.getPrototypeOf(Function),N=typeof Map=="function"&&typeof Map.prototype.entries=="function"?Map:Rt(),le=typeof Set=="function"&&typeof Set.prototype.entries=="function"?Set:It(),ce=typeof WeakMap=="function"?WeakMap:Dt(),V=s?Symbol.for("@reflect-metadata:registry"):void 0,q=bt(),Oe=Ot(q);function ct(a,o,u,c){if(A(u)){if(!Ue(a))throw new TypeError;if(!Fe(o))throw new TypeError;return wt(a,o)}else{if(!Ue(a))throw new TypeError;if(!C(o))throw new TypeError;if(!C(c)&&!A(c)&&!H(c))throw new TypeError;return H(c)&&(c=void 0),u=G(u),Tt(a,o,u,c)}}r("decorate",ct);function ht(a,o){function u(c,v){if(!C(c))throw new TypeError;if(!A(v)&&!Ct(v))throw new TypeError;De(a,o,c,v)}return u}r("metadata",ht);function ft(a,o,u,c){if(!C(u))throw new TypeError;return A(c)||(c=G(c)),De(a,o,u,c)}r("defineMetadata",ft);function dt(a,o,u){if(!C(o))throw new TypeError;return A(u)||(u=G(u)),Pe(a,o,u)}r("hasMetadata",dt);function pt(a,o,u){if(!C(o))throw new TypeError;return A(u)||(u=G(u)),he(a,o,u)}r("hasOwnMetadata",pt);function yt(a,o,u){if(!C(o))throw new TypeError;return A(u)||(u=G(u)),Re(a,o,u)}r("getMetadata",yt);function vt(a,o,u){if(!C(o))throw new TypeError;return A(u)||(u=G(u)),Ie(a,o,u)}r("getOwnMetadata",vt);function gt(a,o){if(!C(a))throw new TypeError;return A(o)||(o=G(o)),ke(a,o)}r("getMetadataKeys",gt);function At(a,o){if(!C(a))throw new TypeError;return A(o)||(o=G(o)),Be(a,o)}r("getOwnMetadataKeys",At);function mt(a,o,u){if(!C(o))throw new TypeError;if(A(u)||(u=G(u)),!C(o))throw new TypeError;A(u)||(u=G(u));var c=X(o,u,!1);return A(c)?!1:c.OrdinaryDeleteMetadata(a,o,u)}r("deleteMetadata",mt);function wt(a,o){for(var u=a.length-1;u>=0;--u){var c=a[u],v=c(o);if(!A(v)&&!H(v)){if(!Fe(v))throw new TypeError;o=v}}return o}function Tt(a,o,u,c){for(var v=a.length-1;v>=0;--v){var E=a[v],_=E(o,u,c);if(!A(_)&&!H(_)){if(!C(_))throw new TypeError;c=_}}return c}function Pe(a,o,u){var c=he(a,o,u);if(c)return!0;var v=de(o);return H(v)?!1:Pe(a,v,u)}function he(a,o,u){var c=X(o,u,!1);return A(c)?!1:Le(c.OrdinaryHasOwnMetadata(a,o,u))}function Re(a,o,u){var c=he(a,o,u);if(c)return Ie(a,o,u);var v=de(o);if(!H(v))return Re(a,v,u)}function Ie(a,o,u){var c=X(o,u,!1);if(!A(c))return c.OrdinaryGetOwnMetadata(a,o,u)}function De(a,o,u,c){var v=X(u,c,!0);v.OrdinaryDefineOwnMetadata(a,o,u,c)}function ke(a,o){var u=Be(a,o),c=de(a);if(c===null)return u;var v=ke(c,o);if(v.length<=0)return u;if(u.length<=0)return v;for(var E=new le,_=[],w=0,h=u;w<h.length;w++){var f=h[w],p=E.has(f);p||(E.add(f),_.push(f))}for(var y=0,T=v;y<T.length;y++){var f=T[y],p=E.has(f);p||(E.add(f),_.push(f))}return _}function Be(a,o){var u=X(a,o,!1);return u?u.OrdinaryOwnMetadataKeys(a,o):[]}function Ge(a){if(a===null)return 1;switch(typeof a){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return a===null?1:6;default:return 6}}function A(a){return a===void 0}function H(a){return a===null}function Mt(a){return typeof a=="symbol"}function C(a){return typeof a=="object"?a!==null:typeof a=="function"}function xt(a,o){switch(Ge(a)){case 0:return a;case 1:return a;case 2:return a;case 3:return a;case 4:return a;case 5:return a}var u="string",c=Ne(a,l);if(c!==void 0){var v=c.call(a,u);if(C(v))throw new TypeError;return v}return Et(a)}function Et(a,o){var u,c,v;{var E=a.toString;if(Z(E)){var c=E.call(a);if(!C(c))return c}var u=a.valueOf;if(Z(u)){var c=u.call(a);if(!C(c))return c}}throw new TypeError}function Le(a){return!!a}function St(a){return""+a}function G(a){var o=xt(a);return Mt(o)?o:St(o)}function Ue(a){return Array.isArray?Array.isArray(a):a instanceof Object?a instanceof Array:Object.prototype.toString.call(a)==="[object Array]"}function Z(a){return typeof a=="function"}function Fe(a){return typeof a=="function"}function Ct(a){switch(Ge(a)){case 3:return!0;case 4:return!0;default:return!1}}function fe(a,o){return a===o||a!==a&&o!==o}function Ne(a,o){var u=a[o];if(u!=null){if(!Z(u))throw new TypeError;return u}}function je(a){var o=Ne(a,g);if(!Z(o))throw new TypeError;var u=o.call(a);if(!C(u))throw new TypeError;return u}function Ve(a){return a.value}function He(a){var o=a.next();return o.done?!1:o}function Qe(a){var o=a.return;o&&o.call(a)}function de(a){var o=Object.getPrototypeOf(a);if(typeof a!="function"||a===F||o!==F)return o;var u=a.prototype,c=u&&Object.getPrototypeOf(u);if(c==null||c===Object.prototype)return o;var v=c.constructor;return typeof v!="function"||v===a?o:v}function _t(){var a;!A(V)&&typeof n.Reflect<"u"&&!(V in n.Reflect)&&typeof n.Reflect.defineMetadata=="function"&&(a=Pt(n.Reflect));var o,u,c,v=new ce,E={registerProvider:_,getProvider:h,setProvider:p};return E;function _(y){if(!Object.isExtensible(E))throw new Error("Cannot add provider to a frozen registry.");switch(!0){case a===y:break;case A(o):o=y;break;case o===y:break;case A(u):u=y;break;case u===y:break;default:c===void 0&&(c=new le),c.add(y);break}}function w(y,T){if(!A(o)){if(o.isProviderFor(y,T))return o;if(!A(u)){if(u.isProviderFor(y,T))return o;if(!A(c))for(var M=je(c);;){var S=He(M);if(!S)return;var B=Ve(S);if(B.isProviderFor(y,T))return Qe(M),B}}}if(!A(a)&&a.isProviderFor(y,T))return a}function h(y,T){var M=v.get(y),S;return A(M)||(S=M.get(T)),A(S)&&(S=w(y,T),A(S)||(A(M)&&(M=new N,v.set(y,M)),M.set(T,S))),S}function f(y){if(A(y))throw new TypeError;return o===y||u===y||!A(c)&&c.has(y)}function p(y,T,M){if(!f(M))throw new Error("Metadata provider not registered.");var S=h(y,T);if(S!==M){if(!A(S))return!1;var B=v.get(y);A(B)&&(B=new N,v.set(y,B)),B.set(T,M)}return!0}}function bt(){var a;return!A(V)&&C(n.Reflect)&&Object.isExtensible(n.Reflect)&&(a=n.Reflect[V]),A(a)&&(a=_t()),!A(V)&&C(n.Reflect)&&Object.isExtensible(n.Reflect)&&Object.defineProperty(n.Reflect,V,{enumerable:!1,configurable:!1,writable:!1,value:a}),a}function Ot(a){var o=new ce,u={isProviderFor:function(f,p){var y=o.get(f);return A(y)?!1:y.has(p)},OrdinaryDefineOwnMetadata:_,OrdinaryHasOwnMetadata:v,OrdinaryGetOwnMetadata:E,OrdinaryOwnMetadataKeys:w,OrdinaryDeleteMetadata:h};return q.registerProvider(u),u;function c(f,p,y){var T=o.get(f),M=!1;if(A(T)){if(!y)return;T=new N,o.set(f,T),M=!0}var S=T.get(p);if(A(S)){if(!y)return;if(S=new N,T.set(p,S),!a.setProvider(f,p,u))throw T.delete(p),M&&o.delete(f),new Error("Wrong provider for target.")}return S}function v(f,p,y){var T=c(p,y,!1);return A(T)?!1:Le(T.has(f))}function E(f,p,y){var T=c(p,y,!1);if(!A(T))return T.get(f)}function _(f,p,y,T){var M=c(y,T,!0);M.set(f,p)}function w(f,p){var y=[],T=c(f,p,!1);if(A(T))return y;for(var M=T.keys(),S=je(M),B=0;;){var Xe=He(S);if(!Xe)return y.length=B,y;var kt=Ve(Xe);try{y[B]=kt}catch(Bt){try{Qe(S)}finally{throw Bt}}B++}}function h(f,p,y){var T=c(p,y,!1);if(A(T)||!T.delete(f))return!1;if(T.size===0){var M=o.get(p);A(M)||(M.delete(y),M.size===0&&o.delete(M))}return!0}}function Pt(a){var o=a.defineMetadata,u=a.hasOwnMetadata,c=a.getOwnMetadata,v=a.getOwnMetadataKeys,E=a.deleteMetadata,_=new ce,w={isProviderFor:function(h,f){var p=_.get(h);return!A(p)&&p.has(f)?!0:v(h,f).length?(A(p)&&(p=new le,_.set(h,p)),p.add(f),!0):!1},OrdinaryDefineOwnMetadata:o,OrdinaryHasOwnMetadata:u,OrdinaryGetOwnMetadata:c,OrdinaryOwnMetadataKeys:v,OrdinaryDeleteMetadata:E};return w}function X(a,o,u){var c=q.getProvider(a,o);if(!A(c))return c;if(u){if(q.setProvider(a,o,Oe))return Oe;throw new Error("Illegal state.")}}function Rt(){var a={},o=[],u=(function(){function w(h,f,p){this._index=0,this._keys=h,this._values=f,this._selector=p}return w.prototype["@@iterator"]=function(){return this},w.prototype[g]=function(){return this},w.prototype.next=function(){var h=this._index;if(h>=0&&h<this._keys.length){var f=this._selector(this._keys[h],this._values[h]);return h+1>=this._keys.length?(this._index=-1,this._keys=o,this._values=o):this._index++,{value:f,done:!1}}return{value:void 0,done:!0}},w.prototype.throw=function(h){throw this._index>=0&&(this._index=-1,this._keys=o,this._values=o),h},w.prototype.return=function(h){return this._index>=0&&(this._index=-1,this._keys=o,this._values=o),{value:h,done:!0}},w})(),c=(function(){function w(){this._keys=[],this._values=[],this._cacheKey=a,this._cacheIndex=-2}return Object.defineProperty(w.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),w.prototype.has=function(h){return this._find(h,!1)>=0},w.prototype.get=function(h){var f=this._find(h,!1);return f>=0?this._values[f]:void 0},w.prototype.set=function(h,f){var p=this._find(h,!0);return this._values[p]=f,this},w.prototype.delete=function(h){var f=this._find(h,!1);if(f>=0){for(var p=this._keys.length,y=f+1;y<p;y++)this._keys[y-1]=this._keys[y],this._values[y-1]=this._values[y];return this._keys.length--,this._values.length--,fe(h,this._cacheKey)&&(this._cacheKey=a,this._cacheIndex=-2),!0}return!1},w.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=a,this._cacheIndex=-2},w.prototype.keys=function(){return new u(this._keys,this._values,v)},w.prototype.values=function(){return new u(this._keys,this._values,E)},w.prototype.entries=function(){return new u(this._keys,this._values,_)},w.prototype["@@iterator"]=function(){return this.entries()},w.prototype[g]=function(){return this.entries()},w.prototype._find=function(h,f){if(!fe(this._cacheKey,h)){this._cacheIndex=-1;for(var p=0;p<this._keys.length;p++)if(fe(this._keys[p],h)){this._cacheIndex=p;break}}return this._cacheIndex<0&&f&&(this._cacheIndex=this._keys.length,this._keys.push(h),this._values.push(void 0)),this._cacheIndex},w})();return c;function v(w,h){return w}function E(w,h){return h}function _(w,h){return[w,h]}}function It(){var a=(function(){function o(){this._map=new N}return Object.defineProperty(o.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),o.prototype.has=function(u){return this._map.has(u)},o.prototype.add=function(u){return this._map.set(u,u),this},o.prototype.delete=function(u){return this._map.delete(u)},o.prototype.clear=function(){this._map.clear()},o.prototype.keys=function(){return this._map.keys()},o.prototype.values=function(){return this._map.keys()},o.prototype.entries=function(){return this._map.entries()},o.prototype["@@iterator"]=function(){return this.keys()},o.prototype[g]=function(){return this.keys()},o})();return a}function Dt(){var a=16,o=b.create(),u=c();return(function(){function h(){this._key=c()}return h.prototype.has=function(f){var p=v(f,!1);return p!==void 0?b.has(p,this._key):!1},h.prototype.get=function(f){var p=v(f,!1);return p!==void 0?b.get(p,this._key):void 0},h.prototype.set=function(f,p){var y=v(f,!0);return y[this._key]=p,this},h.prototype.delete=function(f){var p=v(f,!1);return p!==void 0?delete p[this._key]:!1},h.prototype.clear=function(){this._key=c()},h})();function c(){var h;do h="@@WeakMap@@"+w();while(b.has(o,h));return o[h]=!0,h}function v(h,f){if(!i.call(h,u)){if(!f)return;Object.defineProperty(h,u,{value:b.create()})}return h[u]}function E(h,f){for(var p=0;p<f;++p)h[p]=Math.random()*255|0;return h}function _(h){if(typeof Uint8Array=="function"){var f=new Uint8Array(h);return typeof crypto<"u"?crypto.getRandomValues(f):typeof msCrypto<"u"?msCrypto.getRandomValues(f):E(f,h),f}return E(new Array(h),h)}function w(){var h=_(a);h[6]=h[6]&79|64,h[8]=h[8]&191|128;for(var f="",p=0;p<a;++p){var y=h[p];(p===4||p===6||p===8)&&(f+="-"),y<16&&(f+="0"),f+=y.toString(16).toLowerCase()}return f}}function pe(a){return a.__=void 0,delete a.__,a}})})(t||(t={})),$e}Gt();var ge;(function(t){t[t.Transient=0]="Transient",t[t.Singleton=1]="Singleton",t[t.ResolutionScoped=2]="ResolutionScoped",t[t.ContainerScoped=3]="ContainerScoped"})(ge||(ge={}));const P=ge;var Ae=function(t,e){return Ae=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i])},Ae(t,e)};function _e(t,e){Ae(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}function Lt(t,e,r,n){function i(s){return s instanceof r?s:new r(function(l){l(s)})}return new(r||(r=Promise))(function(s,l){function g(x){try{d(n.next(x))}catch(b){l(b)}}function m(x){try{d(n.throw(x))}catch(b){l(b)}}function d(x){x.done?s(x.value):i(x.value).then(g,m)}d((n=n.apply(t,[])).next())})}function Ut(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,i,s,l;return l={next:g(0),throw:g(1),return:g(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function g(d){return function(x){return m([d,x])}}function m(d){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(s=d[0]&2?i.return:d[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,d[1])).done)return s;switch(i=0,s&&(d=[d[0]&2,s.value]),d[0]){case 0:case 1:s=d;break;case 4:return r.label++,{value:d[1],done:!1};case 5:r.label++,i=d[1],d=[0];continue;case 7:d=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(d[0]===6||d[0]===2)){r=0;continue}if(d[0]===3&&(!s||d[1]>s[0]&&d[1]<s[3])){r.label=d[1];break}if(d[0]===6&&r.label<s[1]){r.label=s[1],s=d;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(d);break}s[2]&&r.ops.pop(),r.trys.pop();continue}d=e.call(t,r)}catch(x){d=[6,x],i=0}finally{n=s=0}if(d[0]&5)throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}}function J(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function ne(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),i,s=[],l;try{for(;(e===void 0||e-- >0)&&!(i=n.next()).done;)s.push(i.value)}catch(g){l={error:g}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(l)throw l.error}}return s}function j(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(ne(arguments[e]));return t}var me="injectionTokens";function Ft(t){var e=Reflect.getMetadata("design:paramtypes",t)||[],r=Reflect.getOwnMetadata(me,t)||{};return Object.keys(r).forEach(function(n){e[+n]=r[n]}),e}function Nt(t,e){return function(r,n,i){var s=Reflect.getOwnMetadata(me,r)||{};s[i]=t,Reflect.defineMetadata(me,s,r)}}function nt(t){return!!t.useClass}function we(t){return!!t.useFactory}var it=(function(){function t(e){this.wrap=e,this.reflectMethods=["get","getPrototypeOf","setPrototypeOf","getOwnPropertyDescriptor","defineProperty","has","set","deleteProperty","apply","construct","ownKeys"]}return t.prototype.createProxy=function(e){var r=this,n={},i=!1,s,l=function(){return i||(s=e(r.wrap()),i=!0),s};return new Proxy(n,this.createHandler(l))},t.prototype.createHandler=function(e){var r={},n=function(i){r[i]=function(){for(var s=[],l=0;l<arguments.length;l++)s[l]=arguments[l];s[0]=e();var g=Reflect[i];return g.apply(void 0,j(s))}};return this.reflectMethods.forEach(n),r},t})();function Q(t){return typeof t=="string"||typeof t=="symbol"}function jt(t){return typeof t=="object"&&"token"in t&&"multiple"in t}function ze(t){return typeof t=="object"&&"token"in t&&"transform"in t}function Vt(t){return typeof t=="function"||t instanceof it}function te(t){return!!t.useToken}function re(t){return t.useValue!=null}function Ht(t){return nt(t)||re(t)||te(t)||we(t)}var be=(function(){function t(){this._registryMap=new Map}return t.prototype.entries=function(){return this._registryMap.entries()},t.prototype.getAll=function(e){return this.ensure(e),this._registryMap.get(e)},t.prototype.get=function(e){this.ensure(e);var r=this._registryMap.get(e);return r[r.length-1]||null},t.prototype.set=function(e,r){this.ensure(e),this._registryMap.get(e).push(r)},t.prototype.setAll=function(e,r){this._registryMap.set(e,r)},t.prototype.has=function(e){return this.ensure(e),this._registryMap.get(e).length>0},t.prototype.clear=function(){this._registryMap.clear()},t.prototype.ensure=function(e){this._registryMap.has(e)||this._registryMap.set(e,[])},t})(),Qt=(function(t){_e(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e})(be),K=(function(){function t(){this.scopedResolutions=new Map}return t})();function Xt(t,e){if(t===null)return"at position #"+e;var r=t.split(",")[e].trim();return'"'+r+'" at position #'+e}function Wt(t,e,r){return r===void 0&&(r="    "),j([t],e.message.split(`
`).map(function(n){return r+n})).join(`
`)}function $t(t,e,r){var n=ne(t.toString().match(/constructor\(([\w, ]+)\)/)||[],2),i=n[1],s=i===void 0?null:i,l=Xt(s,e);return Wt("Cannot inject the dependency "+l+' of "'+t.name+'" constructor. Reason:',r)}function Yt(t){if(typeof t.dispose!="function")return!1;var e=t.dispose;return!(e.length>0)}var zt=(function(t){_e(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e})(be),qt=(function(t){_e(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e})(be),Zt=(function(){function t(){this.preResolution=new zt,this.postResolution=new qt}return t})(),st=new Map,Jt=(function(){function t(e){this.parent=e,this._registry=new Qt,this.interceptors=new Zt,this.disposed=!1,this.disposables=new Set}return t.prototype.register=function(e,r,n){n===void 0&&(n={lifecycle:P.Transient}),this.ensureNotDisposed();var i;if(Ht(r)?i=r:i={useClass:r},te(i))for(var s=[e],l=i;l!=null;){var g=l.useToken;if(s.includes(g))throw new Error("Token registration cycle detected! "+j(s,[g]).join(" -> "));s.push(g);var m=this._registry.get(g);m&&te(m.provider)?l=m.provider:l=null}if((n.lifecycle===P.Singleton||n.lifecycle==P.ContainerScoped||n.lifecycle==P.ResolutionScoped)&&(re(i)||we(i)))throw new Error('Cannot use lifecycle "'+P[n.lifecycle]+'" with ValueProviders or FactoryProviders');return this._registry.set(e,{provider:i,options:n}),this},t.prototype.registerType=function(e,r){return this.ensureNotDisposed(),Q(r)?this.register(e,{useToken:r}):this.register(e,{useClass:r})},t.prototype.registerInstance=function(e,r){return this.ensureNotDisposed(),this.register(e,{useValue:r})},t.prototype.registerSingleton=function(e,r){if(this.ensureNotDisposed(),Q(e)){if(Q(r))return this.register(e,{useToken:r},{lifecycle:P.Singleton});if(r)return this.register(e,{useClass:r},{lifecycle:P.Singleton});throw new Error('Cannot register a type name as a singleton without a "to" token')}var n=e;return r&&!Q(r)&&(n=r),this.register(e,{useClass:n},{lifecycle:P.Singleton})},t.prototype.resolve=function(e,r,n){r===void 0&&(r=new K),n===void 0&&(n=!1),this.ensureNotDisposed();var i=this.getRegistration(e);if(!i&&Q(e)){if(n)return;throw new Error('Attempted to resolve unregistered dependency token: "'+e.toString()+'"')}if(this.executePreResolutionInterceptor(e,"Single"),i){var s=this.resolveRegistration(i,r);return this.executePostResolutionInterceptor(e,s,"Single"),s}if(Vt(e)){var s=this.construct(e,r);return this.executePostResolutionInterceptor(e,s,"Single"),s}throw new Error("Attempted to construct an undefined constructor. Could mean a circular dependency problem. Try using `delay` function.")},t.prototype.executePreResolutionInterceptor=function(e,r){var n,i;if(this.interceptors.preResolution.has(e)){var s=[];try{for(var l=J(this.interceptors.preResolution.getAll(e)),g=l.next();!g.done;g=l.next()){var m=g.value;m.options.frequency!="Once"&&s.push(m),m.callback(e,r)}}catch(d){n={error:d}}finally{try{g&&!g.done&&(i=l.return)&&i.call(l)}finally{if(n)throw n.error}}this.interceptors.preResolution.setAll(e,s)}},t.prototype.executePostResolutionInterceptor=function(e,r,n){var i,s;if(this.interceptors.postResolution.has(e)){var l=[];try{for(var g=J(this.interceptors.postResolution.getAll(e)),m=g.next();!m.done;m=g.next()){var d=m.value;d.options.frequency!="Once"&&l.push(d),d.callback(e,r,n)}}catch(x){i={error:x}}finally{try{m&&!m.done&&(s=g.return)&&s.call(g)}finally{if(i)throw i.error}}this.interceptors.postResolution.setAll(e,l)}},t.prototype.resolveRegistration=function(e,r){if(this.ensureNotDisposed(),e.options.lifecycle===P.ResolutionScoped&&r.scopedResolutions.has(e))return r.scopedResolutions.get(e);var n=e.options.lifecycle===P.Singleton,i=e.options.lifecycle===P.ContainerScoped,s=n||i,l;return re(e.provider)?l=e.provider.useValue:te(e.provider)?l=s?e.instance||(e.instance=this.resolve(e.provider.useToken,r)):this.resolve(e.provider.useToken,r):nt(e.provider)?l=s?e.instance||(e.instance=this.construct(e.provider.useClass,r)):this.construct(e.provider.useClass,r):we(e.provider)?l=e.provider.useFactory(this):l=this.construct(e.provider,r),e.options.lifecycle===P.ResolutionScoped&&r.scopedResolutions.set(e,l),l},t.prototype.resolveAll=function(e,r,n){var i=this;r===void 0&&(r=new K),n===void 0&&(n=!1),this.ensureNotDisposed();var s=this.getAllRegistrations(e);if(!s&&Q(e)){if(n)return[];throw new Error('Attempted to resolve unregistered dependency token: "'+e.toString()+'"')}if(this.executePreResolutionInterceptor(e,"All"),s){var l=s.map(function(m){return i.resolveRegistration(m,r)});return this.executePostResolutionInterceptor(e,l,"All"),l}var g=[this.construct(e,r)];return this.executePostResolutionInterceptor(e,g,"All"),g},t.prototype.isRegistered=function(e,r){return r===void 0&&(r=!1),this.ensureNotDisposed(),this._registry.has(e)||r&&(this.parent||!1)&&this.parent.isRegistered(e,!0)},t.prototype.reset=function(){this.ensureNotDisposed(),this._registry.clear(),this.interceptors.preResolution.clear(),this.interceptors.postResolution.clear()},t.prototype.clearInstances=function(){var e,r;this.ensureNotDisposed();try{for(var n=J(this._registry.entries()),i=n.next();!i.done;i=n.next()){var s=ne(i.value,2),l=s[0],g=s[1];this._registry.setAll(l,g.filter(function(m){return!re(m.provider)}).map(function(m){return m.instance=void 0,m}))}}catch(m){e={error:m}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}},t.prototype.createChildContainer=function(){var e,r;this.ensureNotDisposed();var n=new t(this);try{for(var i=J(this._registry.entries()),s=i.next();!s.done;s=i.next()){var l=ne(s.value,2),g=l[0],m=l[1];m.some(function(d){var x=d.options;return x.lifecycle===P.ContainerScoped})&&n._registry.setAll(g,m.map(function(d){return d.options.lifecycle===P.ContainerScoped?{provider:d.provider,options:d.options}:d}))}}catch(d){e={error:d}}finally{try{s&&!s.done&&(r=i.return)&&r.call(i)}finally{if(e)throw e.error}}return n},t.prototype.beforeResolution=function(e,r,n){n===void 0&&(n={frequency:"Always"}),this.interceptors.preResolution.set(e,{callback:r,options:n})},t.prototype.afterResolution=function(e,r,n){n===void 0&&(n={frequency:"Always"}),this.interceptors.postResolution.set(e,{callback:r,options:n})},t.prototype.dispose=function(){return Lt(this,void 0,void 0,function(){var e;return Ut(this,function(r){switch(r.label){case 0:return this.disposed=!0,e=[],this.disposables.forEach(function(n){var i=n.dispose();i&&e.push(i)}),[4,Promise.all(e)];case 1:return r.sent(),[2]}})})},t.prototype.getRegistration=function(e){return this.isRegistered(e)?this._registry.get(e):this.parent?this.parent.getRegistration(e):null},t.prototype.getAllRegistrations=function(e){return this.isRegistered(e)?this._registry.getAll(e):this.parent?this.parent.getAllRegistrations(e):null},t.prototype.construct=function(e,r){var n=this;if(e instanceof it)return e.createProxy(function(s){return n.resolve(s,r)});var i=(function(){var s=st.get(e);if(!s||s.length===0){if(e.length===0)return new e;throw new Error('TypeInfo not known for "'+e.name+'"')}var l=s.map(n.resolveParams(r,e));return new(e.bind.apply(e,j([void 0],l)))})();return Yt(i)&&this.disposables.add(i),i},t.prototype.resolveParams=function(e,r){var n=this;return function(i,s){var l,g,m;try{return jt(i)?ze(i)?i.multiple?(l=n.resolve(i.transform)).transform.apply(l,j([n.resolveAll(i.token,new K,i.isOptional)],i.transformArgs)):(g=n.resolve(i.transform)).transform.apply(g,j([n.resolve(i.token,e,i.isOptional)],i.transformArgs)):i.multiple?n.resolveAll(i.token,new K,i.isOptional):n.resolve(i.token,e,i.isOptional):ze(i)?(m=n.resolve(i.transform,e)).transform.apply(m,j([n.resolve(i.token,e)],i.transformArgs)):n.resolve(i,e)}catch(d){throw new Error($t(r,s,d))}}},t.prototype.ensureNotDisposed=function(){if(this.disposed)throw new Error("This container has been disposed, you cannot interact with a disposed container")},t})(),R=new Jt;function L(t,e){var r={token:t,multiple:!1,isOptional:e};return Nt(r)}function U(t){return function(e){st.set(e,Ft(e))}}function at(){return function(t){U()(t),R.registerSingleton(t)}}if(typeof Reflect>"u"||!Reflect.getMetadata)throw new Error(`tsyringe requires a reflect polyfill. Please add 'import "reflect-metadata"' to the top of your entry point.`);const qe=t=>{let e;const r=new Set,n=(d,x)=>{const b=typeof d=="function"?d(e):d;if(!Object.is(b,e)){const F=e;e=x??(typeof b!="object"||b===null)?b:Object.assign({},e,b),r.forEach(N=>N(e,F))}},i=()=>e,g={setState:n,getState:i,getInitialState:()=>m,subscribe:d=>(r.add(d),()=>r.delete(d))},m=e=t(n,i,g);return g},Kt=(t=>t?qe(t):qe),D=64,W=8,$=10,er=4473924,ee=2236962,tr=4500036,Ze=5592439,ot=100,Te=150,ut=1,Je=200,ye=1e3,rr=16776960,nr=400,z=25,Ke=50,lt=25,ir=150,sr=10,et=10,ar=100,O=Kt(t=>({money:ir,lives:sr,level:1,wave:0,gameOver:!1,actions:{spendMoney:e=>t(r=>({money:r.money-e})),earnMoney:e=>t(r=>({money:r.money+e})),loseLife:()=>t(e=>({lives:e.lives-1})),setWave:e=>t({wave:e}),setLevel:e=>t({level:e}),setGameOver:e=>t({gameOver:e})}}));var or=Object.getOwnPropertyDescriptor,ur=(t,e,r,n)=>{for(var i=n>1?void 0:n?or(e,r):e,s=t.length-1,l;s>=0;s--)(l=t[s])&&(i=l(i)||i);return i},tt=(t,e)=>(r,n)=>e(r,n,t);let Me=class{constructor(t,e){this.turretManager=t,this.uiManager=e}scene;logicGrid=[];graphicsGrid=[];setScene(t){this.scene=t,this.initializeGrid(),this.drawGrid()}handleTileClick(t,e){const r=this.logicGrid[e][t],n=this.getTileCenter(t,e);if(r===1){this.uiManager.hideTurretUI();return}if(r===2){const l=this.turretManager.getTurretAt(n.x,n.y);l&&this.uiManager.showTurretUI(l);return}const{money:i,actions:s}=O.getState();i>=Ke?(this.turretManager.placeTurret(n.x,n.y,this.uiManager.getSelectedTurretType()),this.logicGrid[e][t]=2,s.spendMoney(Ke),this.uiManager.hideTurretUI()):(console.log("Not enough cash!"),this.graphicsGrid[e][t].setFillStyle(16711680),this.scene.time.delayedCall(200,()=>{this.graphicsGrid[e][t].setFillStyle(ee)}))}getTileCenter(t,e){const r=(this.scene.scale.width-$*D)/2,n=(this.scene.scale.height-W*D)/2;return{x:r+t*D+D/2,y:n+e*D+D/2}}initializeGrid(){for(let t=0;t<W;t++){this.logicGrid[t]=[],this.graphicsGrid[t]=[];for(let e=0;e<$;e++)this.logicGrid[t][e]=0}}drawGrid(){const t=(this.scene.scale.width-$*D)/2,e=(this.scene.scale.height-W*D)/2;for(let r=0;r<W;r++)for(let n=0;n<$;n++){const i=t+n*D,s=e+r*D,l=this.scene.add.rectangle(i,s,D,D,ee).setOrigin(0,0).setStrokeStyle(1,er).setInteractive();this.graphicsGrid[r][n]=l,l.on("pointerover",()=>{this.logicGrid[r][n]===0&&l.setFillStyle(tr)}),l.on("pointerout",()=>{this.logicGrid[r][n]===0?l.setFillStyle(ee):this.logicGrid[r][n]===1&&l.setFillStyle(Ze)}),l.on("pointerdown",()=>this.handleTileClick(n,r))}}setupPath(t){t.forEach(e=>{this.graphicsGrid[e.y]&&this.graphicsGrid[e.y][e.x]&&(this.logicGrid[e.y][e.x]=1,this.graphicsGrid[e.y][e.x].setFillStyle(Ze))})}clearGrid(){for(let t=0;t<W;t++)for(let e=0;e<$;e++)this.logicGrid[t][e]=0,this.graphicsGrid[t]&&this.graphicsGrid[t][e]&&this.graphicsGrid[t][e].setFillStyle(ee)}};Me=ur([U(),tt(0,L("TurretManager")),tt(1,L("UIManager"))],Me);const lr=[{path:[{x:0,y:2},{x:1,y:2},{x:2,y:2},{x:2,y:3},{x:2,y:4},{x:3,y:4},{x:4,y:4},{x:5,y:4},{x:5,y:3},{x:5,y:2},{x:5,y:1},{x:6,y:1},{x:7,y:1},{x:8,y:1},{x:9,y:1}],waves:[{enemyCount:5,spawnDelay:1e3},{enemyCount:8,spawnDelay:800},{enemyCount:10,spawnDelay:500}],enemyTexture:"enemy-1"},{path:[{x:0,y:4},{x:1,y:4},{x:2,y:4},{x:2,y:3},{x:2,y:2},{x:3,y:2},{x:4,y:2},{x:5,y:2},{x:6,y:2},{x:7,y:2},{x:7,y:3},{x:7,y:4},{x:7,y:5},{x:8,y:5},{x:9,y:5}],waves:[{enemyCount:10,spawnDelay:1e3},{enemyCount:15,spawnDelay:700},{enemyCount:20,spawnDelay:400}],enemyTexture:"enemy-2"},{path:[{x:0,y:1},{x:1,y:1},{x:2,y:1},{x:3,y:1},{x:4,y:1},{x:4,y:2},{x:4,y:3},{x:4,y:4},{x:5,y:4},{x:6,y:4},{x:7,y:4},{x:8,y:4},{x:8,y:3},{x:8,y:2},{x:8,y:1},{x:9,y:1}],waves:[{enemyCount:15,spawnDelay:900},{enemyCount:20,spawnDelay:600},{enemyCount:25,spawnDelay:300}],enemyTexture:"enemy-3"}];var cr=Object.getOwnPropertyDescriptor,hr=(t,e,r,n)=>{for(var i=n>1?void 0:n?cr(e,r):e,s=t.length-1,l;s>=0;s--)(l=t[s])&&(i=l(i)||i);return i};let xe=class{levels;constructor(){this.levels=lr}setScene(t){}getLevel(t){return this.levels[t]}getTotalLevels(){return this.levels.length}};xe=hr([U()],xe);var k=(t=>(t.QUICK="turret-1",t.HEAVY="turret-2",t.SPLASH="turret-3",t))(k||{});class ve extends I.GameObjects.Sprite{level=1;damage=z;range=Je;fireRate=ye;turretType;nextFire=0;enemies;bullets;constructor(e,r,n,i,s,l){switch(super(e,r,n,l),this.enemies=i,this.bullets=s,this.turretType=l,this.turretType){case k.QUICK:this.damage=z*.7,this.fireRate=ye/2;break;case k.HEAVY:this.damage=z*2,this.fireRate=ye*2;break;case k.SPLASH:this.damage=z*.9,this.range=Je*.8;break}}initialize(){this.scene.add.existing(this),this.anims.play({key:`${this.turretType}_anim`})}update(e,r){if(!this.enemies||e<this.nextFire)return;const n=this.findNearestEnemy();if(n){const i=I.Math.Angle.Between(this.x,this.y,n.x,n.y);this.setRotation(i),this.fireBullet(i),this.nextFire=e+this.fireRate}}upgrade(){this.level++,this.damage+=15,this.range+=20,this.fireRate=Math.max(100,this.fireRate-100)}findNearestEnemy(){let e=null,r=this.range;return this.enemies.getChildren().forEach(n=>{const i=n;if(i.active){const s=I.Math.Distance.Between(this.x,this.y,i.x,i.y);s<r&&(r=s,e=i)}}),e}fireBullet(e){const r=this.bullets.get(this.x,this.y);r&&r.fire(this.x,this.y,e,this.damage,this.turretType)}}class fr extends I.Physics.Arcade.Sprite{damage=z;turretType;constructor(e,r,n){super(e,r,n,"bulletTexture"),e.add.existing(this),e.physics.add.existing(this)}fire(e,r,n,i,s){this.setPosition(e,r),this.setActive(!0),this.setVisible(!0),this.damage=i,this.turretType=s,this.scene.physics.velocityFromRotation(n,nr,this.body.velocity)}update(e,r){(this.x<0||this.x>800||this.y<0||this.y>600)&&(this.setActive(!1),this.setVisible(!1))}}var dr=Object.getOwnPropertyDescriptor,pr=(t,e,r,n)=>{for(var i=n>1?void 0:n?dr(e,r):e,s=t.length-1,l;s>=0;s--)(l=t[s])&&(i=l(i)||i);return i};let Ee=class{scene;turrets;enemies;bullets;constructor(){}setScene(t){this.scene=t,this.turrets=this.scene.add.group({classType:ve,runChildUpdate:!0}),this.bullets=this.scene.physics.add.group({classType:fr,runChildUpdate:!0})}placeTurret(t,e,r){const n=new ve(this.scene,t,e,this.enemies,this.bullets,r);n.initialize(),this.turrets.add(n)}getBulletGroup(){return this.bullets}setEnemyGroup(t){this.enemies=t}getTurretAt(t,e){let r=null;return this.turrets.getChildren().forEach(n=>{const i=n;I.Math.Distance.Between(i.x,i.y,t,e)<1&&(r=i)}),r}upgradeTurret(t){t.upgrade();const e=this.scene.add.graphics();e.lineStyle(2,65280,1),e.strokeCircle(t.x,t.y,t.range),this.scene.time.delayedCall(200,()=>{e.destroy()})}clearTurrets(){this.turrets.clear(!0,!0),this.turrets=this.scene.add.group({classType:ve,runChildUpdate:!0})}};Ee=pr([U()],Ee);class rt extends I.Physics.Arcade.Sprite{path=[];currentPointIndex=0;moveSpeed=Te;health=ot;defense=ut;speed=Te;gameManager;constructor(e,r,n,i,s,l,g,m,d){super(e,r,n,i),e.add.existing(this),e.physics.add.existing(this),this.anims.play(`${i}_anim`),this.path=s,this.currentPointIndex=0,this.health=l,this.speed=g,this.defense=m,this.moveSpeed=g,this.gameManager=d,this.moveToNextPoint()}moveToNextPoint(){if(this.currentPointIndex<this.path.length){const e=this.path[this.currentPointIndex];this.scene.physics.moveTo(this,e.x,e.y,this.moveSpeed)}else this.gameManager.onEnemyReachedEnd(this),this.destroy()}update(e,r){if(!this.active)return;const n=this.path[this.currentPointIndex];I.Math.Distance.Between(this.x,this.y,n.x,n.y)<5&&(this.setPosition(n.x,n.y),this.body?.reset(n.x,n.y),this.currentPointIndex++,this.moveToNextPoint())}takeDamage(e){const r=Math.max(1,e-this.defense);this.health-=r,this.health<=0?this.destroy():(this.setTint(16777215),this.scene.time.delayedCall(100,()=>{this.clearTint()}))}}var yr=Object.getOwnPropertyDescriptor,vr=(t,e,r,n)=>{for(var i=n>1?void 0:n?yr(e,r):e,s=t.length-1,l;s>=0;s--)(l=t[s])&&(i=l(i)||i);return i},gr=(t,e)=>(r,n)=>e(r,n,t);let Se=class{constructor(t){this.gridManager=t}scene;enemyGroup;worldPath=[];spawnTimer;enemiesToSpawn=0;onWaveComplete;isWaveActive=!1;waveNumber=1;enemyTexture;setScene(t){this.scene=t,this.enemyGroup=this.scene.physics.add.group({classType:rt,runChildUpdate:!0})}convertGridPathToWorldPath(t){this.worldPath=t.map(e=>{const r=this.gridManager.getTileCenter(e.x,e.y);return new I.Math.Vector2(r.x,r.y)})}startWave(t,e,r,n,i){this.worldPath.length!==0&&(this.waveNumber=e,this.enemyTexture=i,this.enemiesToSpawn=t.enemyCount,this.isWaveActive=!0,this.onWaveComplete=n,this.spawnTimer=this.scene.time.addEvent({delay:t.spawnDelay,callback:()=>this.spawnEnemy(r),callbackScope:this,repeat:this.enemiesToSpawn-1}))}spawnEnemy(t){if(this.worldPath.length===0)return;const e=this.worldPath[0],r=ot+this.waveNumber*10,n=Te+this.waveNumber*2,i=ut+this.waveNumber*.5,s=new rt(this.scene,e.x,e.y,this.enemyTexture,this.worldPath,r,n,i,t);this.enemyGroup.add(s)}getEnemyGroup(){return this.enemyGroup}update(){this.isWaveActive&&this.spawnTimer?.getOverallProgress()===1&&this.enemyGroup.countActive(!0)===0&&(this.isWaveActive=!1,this.onWaveComplete())}stopWave(){this.spawnTimer&&this.spawnTimer.remove(),this.enemyGroup.clear(!0,!0),this.isWaveActive=!1}};Se=vr([U(),gr(0,L("GridManager"))],Se);var Ar=Object.getOwnPropertyDescriptor,mr=(t,e,r,n)=>{for(var i=n>1?void 0:n?Ar(e,r):e,s=t.length-1,l;s>=0;s--)(l=t[s])&&(i=l(i)||i);return i},wr=(t,e)=>(r,n)=>e(r,n,t);let Ce=class{scene;errorHandler;errorIcon;errorPopup;moneyText;livesText;levelText;waveText;turretUIContainer;turretNameText;turretStatsText;upgradeButton;newLevelButton;startLevelButton;selectedTurret=null;selectedTurretType=k.QUICK;quickTurretButton;heavyTurretButton;splashTurretButton;upgradeTurretCallback;nextLevelCallback;startLevelCallback;constructor(t){this.errorHandler=t}setScene(t,e,r,n){this.scene=t,this.upgradeTurretCallback=e,this.nextLevelCallback=r,this.startLevelCallback=n,this.createUI(),this.createTurretUI(),this.createTurretSelectionUI(),this.createNewLevelButton(),this.createStartLevelButton(),this.createErrorUI(),O.subscribe(i=>{this.moneyText.setText(`Money: $${i.money}`),this.livesText.setText(`Lives: ${i.lives}`),this.levelText.setText(`Level: ${i.level}`),this.waveText.setText(`Wave: ${i.wave}`)})}createUI(){const t={font:"20px Arial",color:"#ffffff",stroke:"#000000",strokeThickness:2};this.moneyText=this.scene.add.text(10,10,"Money: 0",t),this.levelText=this.scene.add.text(10,40,"Level: 1",t),this.livesText=this.scene.add.text(790,10,"Lives: 0",t).setOrigin(1,0),this.waveText=this.scene.add.text(790,40,"Wave: 1",t).setOrigin(1,0)}createTurretUI(){this.turretUIContainer=this.scene.add.container(10,100),this.turretUIContainer.setVisible(!1);const t=this.scene.add.rectangle(0,0,180,150,0,.7).setOrigin(0);this.turretUIContainer.add(t),this.turretNameText=this.scene.add.text(10,10,"",{font:"18px Arial",color:"#ffffff"}),this.turretStatsText=this.scene.add.text(10,40,"",{font:"14px Arial",color:"#ffffff"}),this.upgradeButton=this.scene.add.text(90,120,"Upgrade",{font:"16px Arial",color:"#00ff00"}).setOrigin(.5,0).setInteractive().on("pointerdown",()=>{this.selectedTurret&&(this.upgradeTurretCallback(this.selectedTurret),this.updateTurretUI())}),this.turretUIContainer.add([this.turretNameText,this.turretStatsText,this.upgradeButton])}showTurretUI(t){this.selectedTurret=t,this.updateTurretUI(),this.turretUIContainer.setVisible(!0)}hideTurretUI(){this.selectedTurret=null,this.turretUIContainer.setVisible(!1)}updateTurretUI(){if(!this.selectedTurret)return;this.turretNameText.setText(`Turret (Lv ${this.selectedTurret.level})`),this.turretStatsText.setText(`Damage: ${this.selectedTurret.damage}
Range: ${this.selectedTurret.range}
Rate: ${1e3/this.selectedTurret.fireRate}/s`);const t=lt*this.selectedTurret.level;this.upgradeButton.setText(`Upgrade ($${t})`);const{money:e}=O.getState();e<t?this.upgradeButton.setColor("#ff0000").disableInteractive():this.upgradeButton.setColor("#00ff00").setInteractive()}createNewLevelButton(){this.newLevelButton=this.scene.add.text(400,300,"Start Next Level",{font:"32px Arial",color:"#00ff00",backgroundColor:"#000000",padding:{x:20,y:10}}).setOrigin(.5).setInteractive().on("pointerdown",()=>{this.nextLevelCallback()}),this.newLevelButton.setVisible(!1)}createStartLevelButton(){this.startLevelButton=this.scene.add.text(400,300,"Start Level",{font:"32px Arial",color:"#00ff00",backgroundColor:"#000000",padding:{x:20,y:10}}).setOrigin(.5).setInteractive().on("pointerdown",()=>{this.startLevelCallback()}),this.startLevelButton.setVisible(!1)}showNewLevelButton(){this.newLevelButton.setVisible(!0)}hideNewLevelButton(){this.newLevelButton.setVisible(!1)}showStartLevelButton(){this.startLevelButton.setVisible(!0)}hideStartLevelButton(){this.startLevelButton.setVisible(!1)}createTurretSelectionUI(){const t=this.scene.add.container(10,300);this.quickTurretButton=this.scene.add.text(0,0,"Build Quick Turret").setInteractive().on("pointerdown",()=>{this.selectedTurretType=k.QUICK,this.updateTurretButtonStyles()}),this.heavyTurretButton=this.scene.add.text(0,30,"Build Heavy Turret").setInteractive().on("pointerdown",()=>{this.selectedTurretType=k.HEAVY,this.updateTurretButtonStyles()}),this.splashTurretButton=this.scene.add.text(0,60,"Build Splash Turret").setInteractive().on("pointerdown",()=>{this.selectedTurretType=k.SPLASH,this.updateTurretButtonStyles()}),t.add([this.quickTurretButton,this.heavyTurretButton,this.splashTurretButton]),this.updateTurretButtonStyles()}updateTurretButtonStyles(){const t={font:"18px Arial",color:"#ffffff"},e={font:"18px Arial",color:"#00ff00"};this.quickTurretButton.setStyle(this.selectedTurretType===k.QUICK?e:t),this.heavyTurretButton.setStyle(this.selectedTurretType===k.HEAVY?e:t),this.splashTurretButton.setStyle(this.selectedTurretType===k.SPLASH?e:t)}getSelectedTurretType(){return this.selectedTurretType}createErrorUI(){this.errorIcon=this.scene.add.text(770,570,"ðŸž",{fontSize:"30px"}).setInteractive().setVisible(!1),this.errorPopup=this.scene.add.container(100,100).setVisible(!1);const t=this.scene.add.graphics();t.fillStyle(0,.8),t.fillRect(0,0,600,400),this.errorPopup.add(t);const e=this.scene.add.text(10,10,"",{fontSize:"16px",color:"#ffffff",wordWrap:{width:580}});this.errorPopup.add(e);const r=this.scene.add.text(590,10,"X",{fontSize:"20px",color:"#ffffff"}).setInteractive().setOrigin(1,0);this.errorPopup.add(r);const n=this.scene.add.text(500,370,"Copy",{fontSize:"20px",color:"#ffffff"}).setInteractive();this.errorPopup.add(n),this.errorIcon.on("pointerdown",()=>{e.setText(this.getFormattedErrors()),this.errorPopup.setVisible(!0)}),r.on("pointerdown",()=>{this.errorPopup.setVisible(!1)}),n.on("pointerdown",()=>{navigator.clipboard.writeText(this.getFormattedErrors())})}getFormattedErrors(){return this.errorHandler.getErrors().map(e=>`${e.message}
${e.stack}`).join(`

`)}update(){this.errorHandler.getErrors().length>0&&this.errorIcon.setVisible(!0)}showGameOver(){this.scene.add.text(400,300,"Game Over",{font:"48px Arial",color:"#ff0000",backgroundColor:"#000000",padding:{x:20,y:10}}).setOrigin(.5)}};Ce=mr([U(),wr(0,L("ErrorHandler"))],Ce);var Tr=Object.getOwnPropertyDescriptor,Mr=(t,e,r,n)=>{for(var i=n>1?void 0:n?Tr(e,r):e,s=t.length-1,l;s>=0;s--)(l=t[s])&&(i=l(i)||i);return i},Y=(t,e)=>(r,n)=>e(r,n,t);let ie=class{constructor(t,e,r,n,i){this.levelManager=t,this.waveManager=e,this.turretManager=r,this.gridManager=n,this.uiManager=i}scene;setScene(t){this.scene=t}initialize(){this.setupPhysics(),O.subscribe(t=>{t.lives<=0&&this.gameOver()})}gameOver(){const{actions:t}=O.getState();t.setGameOver(!0),this.waveManager.stopWave(),this.uiManager.showGameOver()}update(t,e){const{gameOver:r}=O.getState();r||this.waveManager.update()}startCurrentLevel(){this.uiManager.hideStartLevelButton();const{level:t,actions:e}=O.getState(),r=this.levelManager.getLevel(t-1);r?(e.setLevel(t),this.gridManager.setupPath(r.path),this.waveManager.convertGridPathToWorldPath(r.path),this.turretManager.setEnemyGroup(this.waveManager.getEnemyGroup()),this.startWave()):console.log("YOU WON!")}startWave(){const{level:t,wave:e,actions:r}=O.getState(),n=this.levelManager.getLevel(t-1),i=n?.waves[e];i&&n&&(r.setWave(e+1),this.waveManager.startWave(i,e+1,this,this.onWaveComplete.bind(this),n.enemyTexture))}onWaveComplete(){const{level:t,wave:e}=O.getState(),r=this.levelManager.getLevel(t-1);if(r&&e<r.waves.length)this.startWave();else{const{actions:n}=O.getState();n.earnMoney(ar),this.uiManager.showNewLevelButton()}}nextLevel(){const{level:t,actions:e}=O.getState();e.setLevel(t+1),e.setWave(0),this.turretManager.clearTurrets(),this.gridManager.clearGrid(),this.startCurrentLevel(),this.uiManager.hideNewLevelButton()}setupPhysics(){this.scene.physics.add.overlap(this.turretManager.getBulletGroup(),this.waveManager.getEnemyGroup(),(t,e)=>this.handleBulletHit(t,e))}handleBulletHit(t,e){if(t.setActive(!1),t.setVisible(!1),e.takeDamage(t.damage),t.turretType===k.SPLASH&&this.waveManager.getEnemyGroup().getChildren().forEach(n=>{const i=n;if(i.active&&i!==e&&Phaser.Math.Distance.Between(e.x,e.y,i.x,i.y)<=50&&(i.takeDamage(t.damage*.5),!i.active)){const{actions:s}=O.getState();s.earnMoney(et)}}),!e.active){const{actions:r}=O.getState();r.earnMoney(et)}}onEnemyReachedEnd(t){const{actions:e}=O.getState();e.loseLife(),t.destroy(),this.checkGameOver()}checkGameOver(){const{lives:t,actions:e}=O.getState();t<=0&&(e.setGameOver(!0),this.scene.physics.pause(),this.waveManager.stopWave(),this.uiManager.showGameOver())}upgradeTurret(t){const{money:e,actions:r}=O.getState(),n=lt*t.level;e>=n&&(r.spendMoney(n),this.turretManager.upgradeTurret(t))}};ie=Mr([U(),Y(0,L("LevelManager")),Y(1,L("WaveManager")),Y(2,L("TurretManager")),Y(3,L("GridManager")),Y(4,L("UIManager"))],ie);const xr="data:image/png;base64,XHg4OVBOR1xyXG5ceDFhXG4AAAANSUhEUgAAAAEAAAABCAIAAACQd1PeAAAAD0lEQVR4nIupMDD4z8AAAAoIAjTq8zBAAAAAAElFTkSuQmCC",Er="data:image/png;base64,XHg4OVBOR1xyXG5ceDFhXG4AAAANSUhEUgAAAAEAAAABCAIAAACQd1PeAAAAD0lEQVR4nIupMDA4wcAAAAljAf3YHIPCAAAAAElFTkSuQmCC",Sr="data:image/png;base64,XHg4OVBOR1xyXG5ceDFhXG4AAAANSUhEUgAAAAEAAAABCAIAAACQd1PeAAAAD0lEQVR4nIupMDBgYPgPAAgKAjQrhGBDAAAAAElFTkSuQmCC",Cr="data:image/png;base64,XHg4OVBOR1xyXG5ceDFhXG4AAAANSUhEUgAAAAEAAAABCAIAAACQd1PeAAAAD0lEQVR4nIupMDBgYDgBAAfTAf3OPamGAAAAAElFTkSuQmCC",_r="data:image/png;base64,XHg4OVBOR1xyXG5ceDFhXG4AAAANSUhEUgAAAAEAAAABCAIAAACQd1PeAAAAD0lEQVR4nIupMDBg+M8AAAkJAjTxiT8yAAAAAElFTkSuQmCC",br="data:image/png;base64,XHg4OVBOR1xyXG5ceDFhXG4AAAANSUhEUgAAAAEAAAABCAIAAACQd1PeAAAAD0lEQVR4nIupMDBgOMEAAAibAf1UriF0AAAAAElFTkSuQmCC",Or="data:image/png;base64,XHg4OVBOR1xyXG5ceDFhXG4AAAANSUhEUgAAAAEAAAABCAIAAACQd1PeAAAAD0lEQVR4nIupMDD4/58BAAwGAzPZdf/yAAAAAElFTkSuQmCC",Pr="data:image/png;base64,XHg4OVBOR1xyXG5ceDFhXG4AAAANSUhEUgAAAAEAAAABCAIAAACQd1PeAAAAD0lEQVR4nIupMDA4cYIBAArzAsX6qx7TAAAAAElFTkSuQmCC",Rr="data:image/png;base64,XHg4OVBOR1xyXG5ceDFhXG4AAAANSUhEUgAAAAEAAAABCAIAAACQd1PeAAAAD0lEQVR4nIupMDBoYGgAAAkLAjVAuzt2AAAAAElFTkSuQmCC",Ir="data:image/png;base64,XHg4OVBOR1xyXG5ceDFhXG4AAAANSUhEUgAAAAEAAAABCAIAAACQd1PeAAAAD0lEQVR4nIupMDBIYUgBAAibAf3xPJWmAAAAAElFTkSuQmCC",Dr="data:image/png;base64,XHg4OVBOR1xyXG5ceDFhXG4AAAANSUhEUgAAAAEAAAABCAIAAACQd1PeAAAAD0lEQVR4nIupMDD4v5QBAAtSAtldSe0XAAAAAElFTkSuQmCC",kr="data:image/png;base64,XHg4OVBOR1xyXG5ceDFhXG4AAAANSUhEUgAAAAEAAAABCAIAAACQd1PeAAAAD0lEQVR4nIupMDA40cQAAApnAn9tzyAHAAAAAElFTkSuQmCC";var Br=Object.getOwnPropertyDescriptor,Gr=(t,e,r,n)=>{for(var i=n>1?void 0:n?Br(e,r):e,s=t.length-1,l;s>=0;s--)(l=t[s])&&(i=l(i)||i);return i};let se=class{preload(t){t.load.image("enemy-1-1",xr),t.load.image("enemy-1-2",Er),t.load.image("enemy-2-1",Sr),t.load.image("enemy-2-2",Cr),t.load.image("enemy-3-1",_r),t.load.image("enemy-3-2",br),t.load.image("turret-1-1",Or),t.load.image("turret-1-2",Pr),t.load.image("turret-2-1",Rr),t.load.image("turret-2-2",Ir),t.load.image("turret-3-1",Dr),t.load.image("turret-3-2",kr),this.createBulletTexture(t)}createAnimations(t){t.anims.create({key:"enemy-1_anim",frames:[{key:"enemy-1-1"},{key:"enemy-1-2"}],frameRate:2,repeat:-1}),t.anims.create({key:"enemy-2_anim",frames:[{key:"enemy-2-1"},{key:"enemy-2-2"}],frameRate:2,repeat:-1}),t.anims.create({key:"enemy-3_anim",frames:[{key:"enemy-3-1"},{key:"enemy-3-2"}],frameRate:2,repeat:-1}),t.anims.create({key:"turret-1_anim",frames:[{key:"turret-1-1"},{key:"turret-1-2"}],frameRate:2,repeat:-1}),t.anims.create({key:"turret-2_anim",frames:[{key:"turret-2-1"},{key:"turret-2-2"}],frameRate:2,repeat:-1}),t.anims.create({key:"turret-3_anim",frames:[{key:"turret-3-1"},{key:"turret-3-2"}],frameRate:2,repeat:-1})}createBulletTexture(t){const e="bulletTexture";if(!t.textures.exists(e)){const r=t.make.graphics();r.fillStyle(rr,1),r.fillCircle(4,4,4),r.generateTexture(e,8,8)}}};se=Gr([U()],se);var Lr=Object.getOwnPropertyDescriptor,Ur=(t,e,r,n)=>{for(var i=n>1?void 0:n?Lr(e,r):e,s=t.length-1,l;s>=0;s--)(l=t[s])&&(i=l(i)||i);return i},Fr=(t,e)=>(r,n)=>e(r,n,t);let ae=class{constructor(t){this.errorDisplay=t}errors=[];addError(t){console.error(t);const e={message:t.message,stack:t.stack};this.errors.push(e),this.errorDisplay.addError(e)}getErrors(){return this.errors}clearErrors(){this.errors=[],this.errorDisplay.clearErrors()}};ae=Ur([at(),Fr(0,L("ErrorDisplay"))],ae);var Nr=Object.getOwnPropertyDescriptor,jr=(t,e,r,n)=>{for(var i=n>1?void 0:n?Nr(e,r):e,s=t.length-1,l;s>=0;s--)(l=t[s])&&(i=l(i)||i);return i};let oe=class{errorList;errorOverlay;errorToggle;errorCountBadge;errorCount=0;constructor(){const t=document.createElement("div");t.id="error-container",document.body.appendChild(t),this.errorToggle=document.createElement("button"),this.errorToggle.id="error-toggle",this.errorToggle.innerHTML=`
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-bug"><path d="m8 2 1.88 1.88"/><path d="M14.12 3.88 16 2"/><path d="M9 7.13v-1a3.003 3.003 0 1 1 6 0v1"/><path d="M12 20c-3.3 0-6-2.7-6-6v-3a4 4 0 0 1 4-4h4a4 4 0 0 1 4 4v3c0 3.3-2.7 6-6 6"/><path d="M12 20v-8"/><path d="M6.53 9C4.6 9 3 10.6 3 12.5S4.6 16 6.5 16H8"/><path d="M17.5 16c1.9 0 3.5-1.6 3.5-3.5S19.4 9 17.5 9H16"/></svg>
    `,t.appendChild(this.errorToggle),this.errorCountBadge=document.createElement("span"),this.errorCountBadge.id="error-count-badge",this.errorCountBadge.style.display="none",t.appendChild(this.errorCountBadge),this.errorOverlay=document.createElement("div"),this.errorOverlay.id="error-overlay",this.errorOverlay.classList.add("hidden"),document.body.appendChild(this.errorOverlay);const e=document.createElement("div");e.id="error-header",e.innerHTML="<h2>Errors</h2>",this.errorOverlay.appendChild(e);const r=document.createElement("button");r.id="error-close-button",r.innerText="X",e.appendChild(r),this.errorList=document.createElement("ul"),this.errorOverlay.appendChild(this.errorList),this.errorToggle.addEventListener("click",()=>{this.errorOverlay.classList.toggle("hidden")}),r.addEventListener("click",()=>{this.errorOverlay.classList.add("hidden")})}addError(t){this.errorCount++,this.updateBadge();const e=document.createElement("li"),r=document.createElement("details"),n=document.createElement("summary");n.innerText=t.message,r.appendChild(n);const i=document.createElement("pre");i.innerText=t.stack||"No stack trace available",r.appendChild(i);const s=document.createElement("button");s.innerText="Copy Message",s.onclick=()=>{navigator.clipboard.writeText(t.message)};const l=document.createElement("button");l.innerText="Copy Stack",l.onclick=()=>{navigator.clipboard.writeText(t.stack||"")},e.appendChild(r),e.appendChild(s),e.appendChild(l),this.errorList.appendChild(e)}clearErrors(){this.errorList.innerHTML="",this.errorCount=0,this.updateBadge(),this.errorOverlay.classList.add("hidden")}updateBadge(){this.errorCount>0?(this.errorCountBadge.innerText=this.errorCount.toString(),this.errorCountBadge.style.display="block"):this.errorCountBadge.style.display="none"}};oe=jr([at()],oe);R.registerSingleton("AssetsManager",se);R.registerSingleton("ErrorDisplay",oe);R.registerSingleton("ErrorHandler",ae);R.registerSingleton("GridManager",Me);R.registerSingleton("LevelManager",xe);R.registerSingleton("TurretManager",Ee);R.registerSingleton("WaveManager",Se);R.registerSingleton("UIManager",Ce);R.registerSingleton("GameManager",ie);class Vr extends I.Scene{gameManager;assetsManager;constructor(){super("GameScene")}preload(){this.assetsManager=R.resolve(se),this.assetsManager.preload(this)}create(){this.assetsManager.createAnimations(this),this.gameManager=R.resolve(ie),this.gameManager.setScene(this),this.gameManager.gridManager.setScene(this),this.gameManager.waveManager.setScene(this),this.gameManager.turretManager.setScene(this),this.gameManager.levelManager.setScene(this),this.gameManager.uiManager.setScene(this,this.gameManager.upgradeTurret.bind(this.gameManager),this.gameManager.nextLevel.bind(this.gameManager),this.gameManager.startCurrentLevel.bind(this.gameManager)),this.gameManager.initialize(),this.gameManager.uiManager.showStartLevelButton()}update(e,r){this.gameManager.update(e,r),this.gameManager.uiManager.update()}}R.resolve(oe);const ue=R.resolve(ae);window.onerror=(t,e,r,n,i)=>{if(i)ue.addError(i);else{const s=new Error(`Unhandled error: ${t} at ${e}:${r}:${n}`);ue.addError(s)}return!0};window.addEventListener("unhandledrejection",t=>{if(t.reason instanceof Error)ue.addError(t.reason);else{const e=new Error(`Unhandled promise rejection: ${t.reason}`);ue.addError(e)}});const Hr={type:I.AUTO,width:800,height:600,scale:{mode:I.Scale.FIT,autoCenter:I.Scale.CENTER_BOTH},parent:"app",physics:{default:"arcade",arcade:{gravity:{x:0,y:0},debug:!0}},scene:[Vr],backgroundColor:"#2d2d2d"};window.onload=()=>{new I.Game(Hr)};
